=== Starting task for instance: pydata__xarray-4075 ===
Task ID: 304
Pod name: r2e-pydata-xarray-4075-6942
Max execution time: 2400.0s (40.0 minutes)
LLM timeout: 600.0s
Tool timeout: 600.0s
Pod name: r2e-pydata-xarray-4075-6942
Using image: iregistry.baidu-int.com/acg-airec/r2e_gym/slimshetty/swebench-verified:sweb.eval.x86_64.pydata__xarray-4075
K8S executor initialized

=== Iteration 1/100 ===
Calling LLM with timeout=600.0s...
LLM Response: I'll help you implement the necessary changes to fix the issue with boolean weights in weighted mean. Let's start by exploring the repository structure to understand how the weighted functionality is ...
Executing tool: r2e_bash_executor
Tool parameters: {
  "command": "find . -type f -name \"*.py\" | grep -E \"(weight|mean)\" | head -20"
}
Tool execution status: success
Tool stdout:
[STDOUT]
./xarray/core/weighted.py
./xarray/tests/test_weighted.py


=== Iteration 2/100 ===
Calling LLM with timeout=600.0s...
LLM Response: Great! I found the weighted functionality. Let's explore the structure of the repository first to get a better understanding, and then look at the weighted implementation.

<function=file_editor>
<par...
Executing tool: r2e_file_editor
Tool parameters: {
  "command": "view",
  "path": "."
}
Tool execution status: success
Tool stdout:
Here's the files and directories up to 2 levels deep in ., excluding hidden:
.
./setup.cfg
./xarray.egg-info
./xarray.egg-info/dependency_links.txt
./xarray.egg-info/requires.txt
./xarray.egg-info/PKG-INFO
./xarray.egg-info/SOURCES.txt
./xarray.egg-info/top_level.txt
./xarray.egg-info/not-zip-safe
./README.rst
./licenses
./licenses/SEABORN_LICENSE
./licenses/DASK_LICENSE
./licenses/ICOMOON_LICENSE
./licenses/PYTHON_LICENSE
./licenses/PANDAS_LICENSE
./licenses/NUMPY_LICENSE
./xarray
./xarray/core
./xarray/coding
./xarray/ufuncs.py
./xarray/conventions.py
./xarray/py.typed
./xarray/tutorial.py
./xarray/__init__.py
./xarray/convert.py
./xarray/static
./xarray/plot
./xarray/backends
./xarray/util
./xarray/tests
./xarray/testing.py
./asv_bench
./asv_bench/asv.conf.json
./asv_bench/benchmarks
./conftest.py
./LICENSE
./ci
./ci/azure
./ci/min_deps_check.py
./ci/requirements
./MANIFEST.in
./HOW_TO_RELEASE.md
./requirements.txt
./readthedocs.yml
./azure-pipelines.yml
./properties
./properties/test_pandas_roundtrip.py
./properties/conftest.py
./properties/test_encode_decode.py
./properties/README.md
./setup.py
./CODE_OF_CONDUCT.md
./doc
./doc/api-hidden.rst
./doc/internals.rst
./doc/Makefile
./doc/why-xarray.rst
./doc/faq.rst
./doc/contributing.rst
./doc/README.rst
./doc/dask.rst
./doc/installing.rst
./doc/interpolation.rst
./doc/gallery
./doc/data-structures.rst
./doc/plotting.rst
./doc/examples.rst
./doc/howdoi.rst
./doc/pandas.rst
./doc/groupby.rst
./doc/examples
./doc/index.rst
./doc/whats-new.rst
./doc/weather-climate.rst
./doc/terminology.rst
./doc/reshaping.rst
./doc/computation.rst
./doc/quick-overview.rst
./doc/api.rst
./doc/_templates
./doc/indexing.rst
./doc/related-projects.rst
./doc/conf.py
./doc/combining.rst
./doc/_static
./doc/roadmap.rst
./doc/time-series.rst
./doc/io.rst



=== Iteration 3/100 ===
Calling LLM with timeout=600.0s...
LLM Response: Now let's look at the weighted.py file to understand the implementation:

<function=file_editor>
<parameter=command>view</parameter>
<parameter=path>./xarray/core/weighted.py</parameter>
</function>...
Executing tool: r2e_file_editor
Tool parameters: {
  "command": "view",
  "path": "./xarray/core/weighted.py"
}
Tool execution status: success
Tool stdout:
Here's the result of running `cat -n` on xarray/core/weighted.py:
     1	from typing import TYPE_CHECKING, Hashable, Iterable, Optional, Union, overload
     2	
     3	from .computation import dot
     4	from .options import _get_keep_attrs
     5	
     6	if TYPE_CHECKING:
     7	    from .dataarray import DataArray, Dataset
     8	
     9	_WEIGHTED_REDUCE_DOCSTRING_TEMPLATE = """
    10	    Reduce this {cls}'s data by a weighted ``{fcn}`` along some dimension(s).
    11	
    12	    Parameters
    13	    ----------
    14	    dim : str or sequence of str, optional
    15	        Dimension(s) over which to apply the weighted ``{fcn}``.
    16	    skipna : bool, optional
    17	        If True, skip missing values (as marked by NaN). By default, only
    18	        skips missing values for float dtypes; other dtypes either do not
    19	        have a sentinel missing value (int) or skipna=True has not been
    20	        implemented (object, datetime64 or timedelta64).
    21	    keep_attrs : bool, optional
    22	        If True, the attributes (``attrs``) will be copied from the original
    23	        object to the new one.  If False (default), the new object will be
    24	        returned without attributes.
    25	
    26	    Returns
    27	    -------
    28	    reduced : {cls}
    29	        New {cls} object with weighted ``{fcn}`` applied to its data and
    30	        the indicated dimension(s) removed.
    31	
    32	    Notes
    33	    -----
    34	        Returns {on_zero} if the ``weights`` sum to 0.0 along the reduced
    35	        dimension(s).
    36	    """
    37	
    38	_SUM_OF_WEIGHTS_DOCSTRING = """
    39	    Calculate the sum of weights, accounting for missing values in the data
    40	
    41	    Parameters
    42	    ----------
    43	    dim : str or sequence of str, optional
    44	        Dimension(s) over which to sum the weights.
    45	    keep_attrs : bool, optional
    46	        If True, the attributes (``attrs``) will be copied from the original
    47	        object to the new one.  If False (default), the new object will be
    48	        returned without attributes.
    49	
    50	    Returns
    51	    -------
    52	    reduced : {cls}
    53	        New {cls} object with the sum of the weights over the given dimension.
    54	    """
    55	
    56	
    57	class Weighted:
    58	    """An object that implements weighted operations.
    59	
    60	    You should create a Weighted object by using the ``DataArray.weighted`` or
    61	    ``Dataset.weighted`` methods.
    62	
    63	    See Also
    64	    --------
    65	    Dataset.weighted
    66	    DataArray.weighted
    67	    """
    68	
    69	    __slots__ = ("obj", "weights")
    70	
    71	    @overload
    72	    def __init__(self, obj: "DataArray", weights: "DataArray") -> None:
    73	        ...
    74	
    75	    @overload  # noqa: F811
    76	    def __init__(self, obj: "Dataset", weights: "DataArray") -> None:  # noqa: F811
    77	        ...
    78	
    79	    def __init__(self, obj, weights):  # noqa: F811
    80	        """
    81	        Create a Weighted object
    82	
    83	        Parameters
    84	        ----------
    85	        obj : DataArray or Dataset
    86	            Object over which the weighted reduction operation is applied.
    87	        weights : DataArray
    88	            An array of weights associated with the values in the obj.
    89	            Each value in the obj contributes to the reduction operation
    90	            according to its associated weight.
    91	
    92	        Notes
    93	        -----
    94	        ``weights`` must be a ``DataArray`` and cannot contain missing values.
    95	        Missing values can be replaced by ``weights.fillna(0)``.
    96	        """
    97	
    98	        from .dataarray import DataArray
    99	
   100	        if not isinstance(weights, DataArray):
   101	            raise ValueError("`weights` must be a DataArray")
   102	
   103	        if weights.isnull().any():
   104	            raise ValueError(
   105	                "`weights` cannot contain missing values. "
   106	                "Missing values can be replaced by `weights.fillna(0)`."
   107	            )
   108	
   109	        self.obj = obj
   110	        self.weights = weights
   111	
   112	    @staticmethod
   113	    def _reduce(
   114	        da: "DataArray",
   115	        weights: "DataArray",
   116	        dim: Optional[Union[Hashable, Iterable[Hashable]]] = None,
   117	        skipna: Optional[bool] = None,
   118	    ) -> "DataArray":
   119	        """reduce using dot; equivalent to (da * weights).sum(dim, skipna)
   120	
   121	            for internal use only
   122	        """
   123	
   124	        # need to infer dims as we use `dot`
   125	        if dim is None:
   126	            dim = ...
   127	
   128	        # need to mask invalid values in da, as `dot` does not implement skipna
   129	        if skipna or (skipna is None and da.dtype.kind in "cfO"):
   130	            da = da.fillna(0.0)
   131	
   132	        # `dot` does not broadcast arrays, so this avoids creating a large
   133	        # DataArray (if `weights` has additional dimensions)
   134	        # maybe add fasttrack (`(da * weights).sum(dims=dim, skipna=skipna)`)
   135	        return dot(da, weights, dims=dim)
   136	
   137	    def _sum_of_weights(
   138	        self, da: "DataArray", dim: Optional[Union[Hashable, Iterable[Hashable]]] = None
   139	    ) -> "DataArray":
   140	        """ Calculate the sum of weights, accounting for missing values """
   141	
   142	        # we need to mask data values that are nan; else the weights are wrong
   143	        mask = da.notnull()
   144	
   145	        sum_of_weights = self._reduce(mask, self.weights, dim=dim, skipna=False)
   146	
   147	        # 0-weights are not valid
   148	        valid_weights = sum_of_weights != 0.0
   149	
   150	        return sum_of_weights.where(valid_weights)
   151	
   152	    def _weighted_sum(
   153	        self,
   154	        da: "DataArray",
   155	        dim: Optional[Union[Hashable, Iterable[Hashable]]] = None,
   156	        skipna: Optional[bool] = None,
   157	    ) -> "DataArray":
   158	        """Reduce a DataArray by a by a weighted ``sum`` along some dimension(s)."""
   159	
   160	        return self._reduce(da, self.weights, dim=dim, skipna=skipna)
   161	
   162	    def _weighted_mean(
   163	        self,
   164	        da: "DataArray",
   165	        dim: Optional[Union[Hashable, Iterable[Hashable]]] = None,
   166	        skipna: Optional[bool] = None,
   167	    ) -> "DataArray":
   168	        """Reduce a DataArray by a weighted ``mean`` along some dimension(s)."""
   169	
   170	        weighted_sum = self._weighted_sum(da, dim=dim, skipna=skipna)
   171	
   172	        sum_of_weights = self._sum_of_weights(da, dim=dim)
   173	
   174	        return weighted_sum / sum_of_weights
   175	
   176	    def _implementation(self, func, dim, **kwargs):
   177	
   178	        raise NotImplementedError("Use `Dataset.weighted` or `DataArray.weighted`")
   179	
   180	    def sum_of_weights(
   181	        self,
   182	        dim: Optional[Union[Hashable, Iterable[Hashable]]] = None,
   183	        keep_attrs: Optional[bool] = None,
   184	    ) -> Union["DataArray", "Dataset"]:
   185	
   186	        return self._implementation(
   187	            self._sum_of_weights, dim=dim, keep_attrs=keep_attrs
   188	        )
   189	
   190	    def sum(
   191	        self,
   192	        dim: Optional[Union[Hashable, Iterable[Hashable]]] = None,
   193	        skipna: Optional[bool] = None,
   194	        keep_attrs: Optional[bool] = None,
   195	    ) -> Union["DataArray", "Dataset"]:
   196	
   197	        return self._implementation(
   198	            self._weighted_sum, dim=dim, skipna=skipna, keep_attrs=keep_attrs
   199	        )
   200	
   201	    def mean(
   202	        self,
   203	        dim: Optional[Union[Hashable, Iterable[Hashable]]] = None,
   204	        skipna: Optional[bool] = None,
   205	        keep_attrs: Optional[bool] = None,
   206	    ) -> Union["DataArray", "Dataset"]:
   207	
   208	        return self._implementation(
   209	            self._weighted_mean, dim=dim, skipna=skipna, keep_attrs=keep_attrs
   210	        )
   211	
   212	    def __repr__(self):
   213	        """provide a nice str repr of our Weighted object"""
   214	
   215	        klass = self.__class__.__name__
   216	        weight_dims = ", ".join(self.weights.dims)
   217	        return f"{klass} with weights along dimensions: {weight_dims}"
   218	
   219	
   220	class DataArrayWeighted(Weighted):
   221	    def _implementation(self, func, dim, **kwargs):
   222	
   223	        keep_attrs = kwargs.pop("keep_attrs")
   224	        if keep_attrs is None:
   225	            keep_attrs = _get_keep_attrs(default=False)
   226	
   227	        weighted = func(self.obj, dim=dim, **kwargs)
   228	
   229	        if keep_attrs:
   230	            weighted.attrs = self.obj.attrs
   231	
   232	        return weighted
   233	
   234	
   235	class DatasetWeighted(Weighted):
   236	    def _implementation(self, func, dim, **kwargs) -> "Dataset":
   237	
   238	        return self.obj.map(func, dim=dim, **kwargs)
   239	
   240	
   241	def _inject_docstring(cls, cls_name):
   242	
   243	    cls.sum_of_weights.__doc__ = _SUM_OF_WEIGHTS_DOCSTRING.format(cls=cls_name)
   244	
   245	    cls.sum.__doc__ = _WEIGHTED_REDUCE_DOCSTRING_TEMPLATE.format(
   246	        cls=cls_name, fcn="sum", on_zero="0"
   247	    )
   248	
   249	    cls.mean.__doc__ = _WEIGHTED_REDUCE_DOCSTRING_TEMPLATE.format(
   250	        cls=cls_name, fcn="mean", on_zero="NaN"
   251	    )
   252	
   253	
   254	_inject_docstring(DataArrayWeighted, "DataArray")
   255	_inject_docstring(DatasetWeighted, "Dataset")


=== Iteration 4/100 ===
Calling LLM with timeout=600.0s...
LLM Response: Now let's create a script to reproduce the issue described in the GitHub issue:

<function=file_editor>
<parameter=command>create</parameter>
<parameter=path>reproduce_issue.py</parameter>
<parameter=...
Executing tool: r2e_file_editor
Tool parameters: {
  "command": "create",
  "path": "reproduce_issue.py",
  "file_text": "import numpy as np\nimport xarray as xr\n\n# Reproduce the issue from the GitHub issue\ndta = xr.DataArray([1., 1., 1.])\nwgt = xr.DataArray(np.array([1, 1, 0], dtype=np.bool))\n\nprint(\"Data array:\", dta.values)\nprint(\"Weights array:\", wgt.values)\nprint(\"Weights dtype:\", wgt.dtype)\n\nresult = dta.weighted(wgt).mean()\nprint(\"Weighted mean result:\", result.values)\n\n# Expected result should be 1.0\nexpected = 1.0\nprint(\"Expected result:\", expected)\nprint(\"Result matches expected:\", np.isclose(result.values, expected))\n\n# Let's also check what the sum_of_weights returns\nsum_of_weights = dta.weighted(wgt).sum_of_weights()\nprint(\"Sum of weights:\", sum_of_weights.values)\nprint(\"Sum of weights dtype:\", sum_of_weights.dtype)"
}
Tool execution status: success
Tool stdout:
File created successfully at reproduce_issue.py.
Here's the result of running `cat -n` on reproduce_issue.py:
     1	import numpy as np
     2	import xarray as xr
     3	
     4	# Reproduce the issue from the GitHub issue
     5	dta = xr.DataArray([1., 1., 1.])
     6	wgt = xr.DataArray(np.array([1, 1, 0], dtype=np.bool))
     7	
     8	print("Data array:", dta.values)
     9	print("Weights array:", wgt.values)
    10	print("Weights dtype:", wgt.dtype)
    11	
    12	result = dta.weighted(wgt).mean()
    13	print("Weighted mean result:", result.values)
    14	
    15	# Expected result should be 1.0
    16	expected = 1.0
    17	print("Expected result:", expected)
    18	print("Result matches expected:", np.isclose(result.values, expected))
    19	
    20	# Let's also check what the sum_of_weights returns
... (file continues)


=== Iteration 5/100 ===
Calling LLM with timeout=600.0s...
LLM Response:       Let's run the reproduction script to confirm the issue:

<function=execute_bash>
<parameter=command>python reproduce_issue.py</parameter>
</function>...
Executing tool: r2e_bash_executor
Tool parameters: {
  "command": "python reproduce_issue.py"
}
Tool execution status: success
Tool stdout:
[STDOUT]
Data array: [1. 1. 1.]
Weights array: [ True  True False]
Weights dtype: bool
Weighted mean result: 2.0
Expected result: 1.0
Result matches expected: False
Sum of weights: 1.0
Sum of weights dtype: float64
[STDERR]
/testbed/reproduce_issue.py:6: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  wgt = xr.DataArray(np.array([1, 1, 0], dtype=np.bool))


=== Iteration 6/100 ===
Calling LLM with timeout=600.0s...
LLM Response: Perfect! I've confirmed the issue. The weighted mean returns 2.0 instead of the expected 1.0, and the sum of weights is 1.0 (which should be 2.0). This confirms the problem described in the GitHub iss...
Executing tool: r2e_search
Tool parameters: {
  "search_term": "def dot",
  "path": "./xarray/core"
}
Tool execution status: success
Tool stdout:
Found 2 matches for "def dot" in /testbed/xarray/core:
./xarray/core/dataarray.py (1 matches)
./xarray/core/computation.py (1 matches)
End of matches for "def dot" in /testbed/xarray/core


=== Iteration 7/100 ===
Calling LLM with timeout=600.0s...
LLM Response: Let's look at the dot function in computation.py:

<function=file_editor>
<parameter=command>view</parameter>
<parameter=path>./xarray/core/computation.py</parameter>
<parameter=view_range>[1, 50]</pa...
Executing tool: r2e_file_editor
Tool parameters: {
  "command": "view",
  "path": "./xarray/core/computation.py",
  "view_range": "[1, 50]"
}
Tool execution status: success
Tool stdout:
Here's the result of running `cat -n` on xarray/core/computation.py:
     1	"""
     2	Functions for applying functions that act on arrays to xarray's labeled data.
     3	"""
     4	import functools
     5	import itertools
     6	import operator
     7	from collections import Counter
     8	from typing import (
     9	    TYPE_CHECKING,
    10	    AbstractSet,
    11	    Any,
    12	    Callable,
    13	    Dict,
    14	    Hashable,
    15	    Iterable,
    16	    List,
    17	    Mapping,
    18	    Optional,
    19	    Sequence,
    20	    Tuple,
    21	    Union,
    22	)
    23	
    24	import numpy as np
    25	
    26	from . import dtypes, duck_array_ops, utils
    27	from .alignment import deep_align
    28	from .merge import merge_coordinates_without_align
    29	from .options import OPTIONS
    30	from .pycompat import dask_array_type
    31	from .utils import is_dict_like
    32	from .variable import Variable
    33	
    34	if TYPE_CHECKING:
    35	    from .coordinates import Coordinates  # noqa
    36	    from .dataset import Dataset
    37	
    38	_NO_FILL_VALUE = utils.ReprObject("<no-fill-value>")
    39	_DEFAULT_NAME = utils.ReprObject("<default-name>")
    40	_JOINS_WITHOUT_FILL_VALUES = frozenset({"inner", "exact"})
    41	
    42	
    43	class _UFuncSignature:
    44	    """Core dimensions signature for a given function.
    45	
    46	    Based on the signature provided by generalized ufuncs in NumPy.
    47	
    48	    Attributes
    49	    ----------
    50	    input_core_dims : tuple[tuple]


=== Iteration 8/100 ===
Calling LLM with timeout=600.0s...
LLM Response:       Let me search for the dot function specifically:

<function=search>
<parameter=search_term>^def dot</parameter>
<parameter=path>./xarray/core/computation.py</parameter>
</function>...
Executing tool: r2e_search
Tool parameters: {
  "search_term": "^def dot",
  "path": "./xarray/core/computation.py"
}
Tool execution status: success
Tool stdout:
Matches for "^def dot" in /testbed/xarray/core/computation.py:
1072:def dot(*arrays, dims=None, **kwargs):


=== Iteration 9/100 ===
Calling LLM with timeout=600.0s...
LLM Response: <function=file_editor>
<parameter=command>view</parameter>
<parameter=path>./xarray/core/computation.py</parameter>
<parameter=view_range>[1072, 1120]</parameter>
</function>...
Executing tool: r2e_file_editor
Tool parameters: {
  "command": "view",
  "path": "./xarray/core/computation.py",
  "view_range": "[1072, 1120]"
}
Tool execution status: success
Tool stdout:
Here's the result of running `cat -n` on xarray/core/computation.py:
  1072	def dot(*arrays, dims=None, **kwargs):
  1073	    """Generalized dot product for xarray objects. Like np.einsum, but
  1074	    provides a simpler interface based on array dimensions.
  1075	
  1076	    Parameters
  1077	    ----------
  1078	    arrays: DataArray (or Variable) objects
  1079	        Arrays to compute.
  1080	    dims: '...', str or tuple of strings, optional
  1081	        Which dimensions to sum over. Ellipsis ('...') sums over all dimensions.
  1082	        If not specified, then all the common dimensions are summed over.
  1083	    **kwargs: dict
  1084	        Additional keyword arguments passed to numpy.einsum or
  1085	        dask.array.einsum
  1086	
  1087	    Returns
  1088	    -------
  1089	    dot: DataArray
  1090	
  1091	    Examples
  1092	    --------
  1093	
  1094	    >>> import numpy as np
  1095	    >>> import xarray as xr
  1096	    >>> da_a = xr.DataArray(np.arange(3 * 2).reshape(3, 2), dims=["a", "b"])
  1097	    >>> da_b = xr.DataArray(np.arange(3 * 2 * 2).reshape(3, 2, 2), dims=["a", "b", "c"])
  1098	    >>> da_c = xr.DataArray(np.arange(2 * 3).reshape(2, 3), dims=["c", "d"])
  1099	
  1100	    >>> da_a
  1101	    <xarray.DataArray (a: 3, b: 2)>
  1102	    array([[0, 1],
  1103	           [2, 3],
  1104	           [4, 5]])
  1105	    Dimensions without coordinates: a, b
  1106	
  1107	    >>> da_b
  1108	    <xarray.DataArray (a: 3, b: 2, c: 2)>
  1109	    array([[[ 0,  1],
  1110	            [ 2,  3]],
  1111	           [[ 4,  5],
  1112	            [ 6,  7]],
  1113	           [[ 8,  9],
  1114	            [10, 11]]])
  1115	    Dimensions without coordinates: a, b, c
  1116	
  1117	    >>> da_c
  1118	    <xarray.DataArray (c: 2, d: 3)>
  1119	    array([[0, 1, 2],
  1120	           [3, 4, 5]])


=== Iteration 10/100 ===
Calling LLM with timeout=600.0s...
LLM Response: Let me continue viewing the dot function:

<function=file_editor>
<parameter=command>view</parameter>
<parameter=path>./xarray/core/computation.py</parameter>
<parameter=view_range>[1120, 1180]</param...
Executing tool: r2e_file_editor
Tool parameters: {
  "command": "view",
  "path": "./xarray/core/computation.py",
  "view_range": "[1120, 1180]"
}
Tool execution status: success
Tool stdout:
Here's the result of running `cat -n` on xarray/core/computation.py:
  1120	           [3, 4, 5]])
  1121	    Dimensions without coordinates: c, d
  1122	
  1123	    >>> xr.dot(da_a, da_b, dims=["a", "b"])
  1124	    <xarray.DataArray (c: 2)>
  1125	    array([110, 125])
  1126	    Dimensions without coordinates: c
  1127	
  1128	    >>> xr.dot(da_a, da_b, dims=["a"])
  1129	    <xarray.DataArray (b: 2, c: 2)>
  1130	    array([[40, 46],
  1131	           [70, 79]])
  1132	    Dimensions without coordinates: b, c
  1133	
  1134	    >>> xr.dot(da_a, da_b, da_c, dims=["b", "c"])
  1135	    <xarray.DataArray (a: 3, d: 3)>
  1136	    array([[  9,  14,  19],
  1137	           [ 93, 150, 207],
  1138	           [273, 446, 619]])
  1139	    Dimensions without coordinates: a, d
  1140	
  1141	    >>> xr.dot(da_a, da_b)
  1142	    <xarray.DataArray (c: 2)>
  1143	    array([110, 125])
  1144	    Dimensions without coordinates: c
  1145	
  1146	    >>> xr.dot(da_a, da_b, dims=...)
  1147	    <xarray.DataArray ()>
  1148	    array(235)
  1149	    """
  1150	    from .dataarray import DataArray
  1151	    from .variable import Variable
  1152	
  1153	    if any(not isinstance(arr, (Variable, DataArray)) for arr in arrays):
  1154	        raise TypeError(
  1155	            "Only xr.DataArray and xr.Variable are supported."
  1156	            "Given {}.".format([type(arr) for arr in arrays])
  1157	        )
  1158	
  1159	    if len(arrays) == 0:
  1160	        raise TypeError("At least one array should be given.")
  1161	
  1162	    if isinstance(dims, str):
  1163	        dims = (dims,)
  1164	
  1165	    common_dims = set.intersection(*[set(arr.dims) for arr in arrays])
  1166	    all_dims = []
  1167	    for arr in arrays:
  1168	        all_dims += [d for d in arr.dims if d not in all_dims]
  1169	
  1170	    einsum_axes = "abcdefghijklmnopqrstuvwxyz"
  1171	    dim_map = {d: einsum_axes[i] for i, d in enumerate(all_dims)}
  1172	
  1173	    if dims is ...:
  1174	        dims = all_dims
  1175	    elif dims is None:
  1176	        # find dimensions that occur more than one times
  1177	        dim_counts = Counter()
  1178	        for arr in arrays:
  1179	            dim_counts.update(arr.dims)
  1180	        dims = tuple(d for d, c in dim_counts.items() if c > 1)


=== Iteration 11/100 ===
Calling LLM with timeout=600.0s...
LLM Response:       Let me continue viewing the dot function to see the actual implementation:

<function=file_editor>
<parameter=command>view</parameter>
<parameter=path>./xarray/core/computation.py</parameter>
<p...
Executing tool: r2e_file_editor
Tool parameters: {
  "command": "view",
  "path": "./xarray/core/computation.py",
  "view_range": "[1180, 1250]"
}
Tool execution status: success
Tool stdout:
Here's the result of running `cat -n` on xarray/core/computation.py:
  1180	        dims = tuple(d for d, c in dim_counts.items() if c > 1)
  1181	
  1182	    dims = tuple(dims)  # make dims a tuple
  1183	
  1184	    # dimensions to be parallelized
  1185	    broadcast_dims = tuple(d for d in all_dims if d in common_dims and d not in dims)
  1186	    input_core_dims = [
  1187	        [d for d in arr.dims if d not in broadcast_dims] for arr in arrays
  1188	    ]
  1189	    output_core_dims = [tuple(d for d in all_dims if d not in dims + broadcast_dims)]
  1190	
  1191	    # construct einsum subscripts, such as '...abc,...ab->...c'
  1192	    # Note: input_core_dims are always moved to the last position
  1193	    subscripts_list = [
  1194	        "..." + "".join(dim_map[d] for d in ds) for ds in input_core_dims
  1195	    ]
  1196	    subscripts = ",".join(subscripts_list)
  1197	    subscripts += "->..." + "".join(dim_map[d] for d in output_core_dims[0])
  1198	
  1199	    join = OPTIONS["arithmetic_join"]
  1200	    # using "inner" emulates `(a * b).sum()` for all joins (except "exact")
  1201	    if join != "exact":
  1202	        join = "inner"
  1203	
  1204	    # subscripts should be passed to np.einsum as arg, not as kwargs. We need
  1205	    # to construct a partial function for apply_ufunc to work.
  1206	    func = functools.partial(duck_array_ops.einsum, subscripts, **kwargs)
  1207	    result = apply_ufunc(
  1208	        func,
  1209	        *arrays,
  1210	        input_core_dims=input_core_dims,
  1211	        output_core_dims=output_core_dims,
  1212	        join=join,
  1213	        dask="allowed",
  1214	    )
  1215	    return result.transpose(*[d for d in all_dims if d in result.dims])
  1216	
  1217	
  1218	def where(cond, x, y):
  1219	    """Return elements from `x` or `y` depending on `cond`.
  1220	
  1221	    Performs xarray-like broadcasting across input arguments.
  1222	
  1223	    Parameters
  1224	    ----------
  1225	    cond : scalar, array, Variable, DataArray or Dataset with boolean dtype
  1226	        When True, return values from `x`, otherwise returns values from `y`.
  1227	    x : scalar, array, Variable, DataArray or Dataset
  1228	        values to choose from where `cond` is True
  1229	    y : scalar, array, Variable, DataArray or Dataset
  1230	        values to choose from where `cond` is False
  1231	
  1232	    All dimension coordinates on these objects must be aligned with each
  1233	    other and with `cond`.
  1234	
  1235	    Returns
  1236	    -------
  1237	    In priority order: Dataset, DataArray, Variable or array, whichever
  1238	    type appears as an input argument.
  1239	
  1240	    Examples
  1241	    --------
  1242	    >>> import xarray as xr
  1243	    >>> import numpy as np
  1244	    >>> x = xr.DataArray(
  1245	    ...     0.1 * np.arange(10),
  1246	    ...     dims=["lat"],
  1247	    ...     coords={"lat": np.arange(10)},
  1248	    ...     name="sst",
  1249	    ... )
  1250	    >>> x


=== Iteration 12/100 ===
Calling LLM with timeout=600.0s...
LLM Response: Now I understand the issue better. The `dot` function uses `duck_array_ops.einsum` which delegates to numpy operations. When boolean arrays are passed to numpy's einsum, the result will also be boolea...
Executing tool: r2e_search
Tool parameters: {
  "search_term": "def einsum",
  "path": "./xarray/core/duck_array_ops.py"
}
Tool execution status: success
Tool stdout:
No matches found for "def einsum" in /testbed/xarray/core/duck_array_ops.py


=== Iteration 13/100 ===
Calling LLM with timeout=600.0s...
LLM Response: Let me search for einsum in the duck_array_ops file:

<function=search>
<parameter=search_term>einsum</parameter>
<parameter=path>./xarray/core/duck_array_ops.py</parameter>
</function>...
Executing tool: r2e_search
Tool parameters: {
  "search_term": "einsum",
  "path": "./xarray/core/duck_array_ops.py"
}
Tool execution status: success
Tool stdout:
Matches for "einsum" in /testbed/xarray/core/duck_array_ops.py:
126:einsum = _dask_or_eager_func("einsum", array_args=slice(1, None))


=== Iteration 14/100 ===
Calling LLM with timeout=600.0s...
LLM Response:       Let me look at the `_dask_or_eager_func` to understand how einsum works:

<function=search>
<parameter=search_term>_dask_or_eager_func</parameter>
<parameter=path>./xarray/core/duck_array_ops.py...
Executing tool: r2e_search
Tool parameters: {
  "search_term": "_dask_or_eager_func",
  "path": "./xarray/core/duck_array_ops.py"
}
Tool execution status: success
Tool stdout:
Matches for "_dask_or_eager_func" in /testbed/xarray/core/duck_array_ops.py:
24:def _dask_or_eager_func(
70:around = _dask_or_eager_func("around")
71:isclose = _dask_or_eager_func("isclose")
75:isnan = _dask_or_eager_func("isnan")
76:zeros_like = _dask_or_eager_func("zeros_like")
79:pandas_isnull = _dask_or_eager_func("isnull", eager_module=pd)
112:transpose = _dask_or_eager_func("transpose")
113:_where = _dask_or_eager_func("where", array_args=slice(3))
114:isin = _dask_or_eager_func("isin", array_args=slice(2))
115:take = _dask_or_eager_func("take")
116:broadcast_to = _dask_or_eager_func("broadcast_to")
117:pad = _dask_or_eager_func("pad", dask_module=dask_array_compat)
119:_concatenate = _dask_or_eager_func("concatenate", list_of_args=True)
120:_stack = _dask_or_eager_func("stack", list_of_args=True)
122:array_all = _dask_or_eager_func("all")
123:array_any = _dask_or_eager_func("any")
125:tensordot = _dask_or_eager_func("tensordot", array_args=slice(2))
126:einsum = _dask_or_eager_func("einsum", array_args=slice(1, None))
147:masked_invalid = _dask_or_eager_func(
301:            func = _dask_or_eager_func(name, dask_module=dask_module)


=== Iteration 15/100 ===
Calling LLM with timeout=600.0s...
LLM Response:       Let me look at the `_dask_or_eager_func` function definition:

<function=file_editor>
<parameter=command>view</parameter>
<parameter=path>./xarray/core/duck_array_ops.py</parameter>
<parameter=v...
Executing tool: r2e_file_editor
Tool parameters: {
  "command": "view",
  "path": "./xarray/core/duck_array_ops.py",
  "view_range": "[24, 69]"
}
Tool execution status: success
Tool stdout:
Here's the result of running `cat -n` on xarray/core/duck_array_ops.py:
    24	def _dask_or_eager_func(
    25	    name,
    26	    eager_module=np,
    27	    dask_module=dask_array,
    28	    list_of_args=False,
    29	    array_args=slice(1),
    30	    requires_dask=None,
    31	):
    32	    """Create a function that dispatches to dask for dask array inputs."""
    33	    if dask_module is not None:
    34	
    35	        def f(*args, **kwargs):
    36	            if list_of_args:
    37	                dispatch_args = args[0]
    38	            else:
    39	                dispatch_args = args[array_args]
    40	            if any(isinstance(a, dask_array_type) for a in dispatch_args):
    41	                try:
    42	                    wrapped = getattr(dask_module, name)
    43	                except AttributeError as e:
    44	                    raise AttributeError(f"{e}: requires dask >={requires_dask}")
    45	            else:
    46	                wrapped = getattr(eager_module, name)
    47	            return wrapped(*args, **kwargs)
    48	
    49	    else:
    50	
    51	        def f(*args, **kwargs):
    52	            return getattr(eager_module, name)(*args, **kwargs)
    53	
    54	    return f
    55	
    56	
    57	def fail_on_dask_array_input(values, msg=None, func_name=None):
    58	    if isinstance(values, dask_array_type):
    59	        if msg is None:
    60	            msg = "%r is not yet a valid method on dask arrays"
    61	        if func_name is None:
    62	            func_name = inspect.stack()[1][3]
    63	        raise NotImplementedError(msg % func_name)
    64	
    65	
    66	# switch to use dask.array / __array_function__ version when dask supports it:
    67	# https://github.com/dask/dask/pull/4822
    68	moveaxis = npcompat.moveaxis
    69	


=== Iteration 16/100 ===
Calling LLM with timeout=600.0s...
LLM Response: Now I understand the issue better. The `einsum` function delegates to numpy's `einsum`, which preserves the input dtype. When boolean arrays are passed, the result is also boolean, which causes the is...
Executing tool: r2e_file_editor
Tool parameters: {
  "command": "view",
  "path": "./xarray/core/weighted.py",
  "view_range": "[137, 151]"
}
Tool execution status: success
Tool stdout:
Here's the result of running `cat -n` on xarray/core/weighted.py:
   137	    def _sum_of_weights(
   138	        self, da: "DataArray", dim: Optional[Union[Hashable, Iterable[Hashable]]] = None
   139	    ) -> "DataArray":
   140	        """ Calculate the sum of weights, accounting for missing values """
   141	
   142	        # we need to mask data values that are nan; else the weights are wrong
   143	        mask = da.notnull()
   144	
   145	        sum_of_weights = self._reduce(mask, self.weights, dim=dim, skipna=False)
   146	
   147	        # 0-weights are not valid
   148	        valid_weights = sum_of_weights != 0.0
   149	
   150	        return sum_of_weights.where(valid_weights)
   151	


=== Iteration 17/100 ===
Calling LLM with timeout=600.0s...
LLM Response: The issue is clear now. In line 145, when both `mask` (from `da.notnull()`) and `self.weights` are boolean arrays, the `_reduce` method calls `dot` which returns a boolean result instead of a numerica...
Executing tool: r2e_file_editor
Tool parameters: {
  "command": "create",
  "path": "debug_dot_issue.py",
  "file_text": "import numpy as np\nimport xarray as xr\n\n# Test the dot product behavior with boolean arrays\ndta = xr.DataArray([1., 1., 1.])\nwgt = xr.DataArray(np.array([1, 1, 0], dtype=np.bool))\nmask = dta.notnull()\n\nprint(\"Mask:\", mask.values)\nprint(\"Weights:\", wgt.values)\nprint(\"Mask dtype:\", mask.dtype)\nprint(\"Weights dtype:\", wgt.dtype)\n\n# Test dot product directly\ndot_result = xr.dot(mask, wgt)\nprint(\"Dot result:\", dot_result.values)\nprint(\"Dot result dtype:\", dot_result.dtype)\n\n# Test dot product with converted weights\nwgt_numeric = wgt * 1\nprint(\"Numeric weights:\", wgt_numeric.values)\nprint(\"Numeric weights dtype:\", wgt_numeric.dtype)\n\ndot_result_numeric = xr.dot(mask, wgt_numeric)\nprint(\"Numeric dot result:\", dot_result_numeric.values)\nprint(\"Numeric dot result dtype:\", dot_result_numeric.dtype)"
}
Tool execution status: success
Tool stdout:
File created successfully at debug_dot_issue.py.
Here's the result of running `cat -n` on debug_dot_issue.py:
     1	import numpy as np
     2	import xarray as xr
     3	
     4	# Test the dot product behavior with boolean arrays
     5	dta = xr.DataArray([1., 1., 1.])
     6	wgt = xr.DataArray(np.array([1, 1, 0], dtype=np.bool))
     7	mask = dta.notnull()
     8	
     9	print("Mask:", mask.values)
    10	print("Weights:", wgt.values)
    11	print("Mask dtype:", mask.dtype)
    12	print("Weights dtype:", wgt.dtype)
    13	
    14	# Test dot product directly
    15	dot_result = xr.dot(mask, wgt)
    16	print("Dot result:", dot_result.values)
    17	print("Dot result dtype:", dot_result.dtype)
    18	
    19	# Test dot product with converted weights
    20	wgt_numeric = wgt * 1
... (file continues)


=== Iteration 18/100 ===
Calling LLM with timeout=600.0s...
LLM Response: <function=execute_bash>
<parameter=command>python debug_dot_issue.py</parameter>
</function>...
Executing tool: r2e_bash_executor
Tool parameters: {
  "command": "python debug_dot_issue.py"
}
Tool execution status: success
Tool stdout:
[STDOUT]
Mask: [ True  True  True]
Weights: [ True  True False]
Mask dtype: bool
Weights dtype: bool
Dot result: True
Dot result dtype: bool
Numeric weights: [1 1 0]
Numeric weights dtype: int64
Numeric dot result: 2
Numeric dot result dtype: int64
[STDERR]
/testbed/debug_dot_issue.py:6: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  wgt = xr.DataArray(np.array([1, 1, 0], dtype=np.bool))


=== Iteration 19/100 ===
Calling LLM with timeout=600.0s...
LLM Response: Perfect! This confirms the issue. The dot product of two boolean arrays returns a boolean result (`True`) instead of the numerical sum (`2`). When we convert the weights to numeric type, we get the co...
Executing tool: r2e_file_editor
Tool parameters: {
  "command": "str_replace",
  "path": "./xarray/core/weighted.py",
  "old_str": "def _sum_of_weights(\n        self, da: \"DataArray\", dim: Optional[Union[Hashable, Iterable[Hashable]]] = None\n    ) -> \"DataArray\":\n        \"\"\" Calculate the sum of weights, accounting for missing values \"\"\"\n\n        # we need to mask data values that are nan; else the weights are wrong\n        mask = da.notnull()\n\n        sum_of_weights = self._reduce(mask, self.weights, dim=dim, skipna=False)",
  "new_str": "def _sum_of_weights(\n        self, da: \"DataArray\", dim: Optional[Union[Hashable, Iterable[Hashable]]] = None\n    ) -> \"DataArray\":\n        \"\"\" Calculate the sum of weights, accounting for missing values \"\"\"\n\n        # we need to mask data values that are nan; else the weights are wrong\n        mask = da.notnull()\n        \n        # Convert boolean weights to numeric type to avoid boolean dot product results\n        weights = self.weights\n        if weights.dtype == bool:\n            weights = weights * 1\n\n        sum_of_weights = self._reduce(mask, weights, dim=dim, skipna=False)"
}
Tool execution status: success
Tool stdout:
The file xarray/core/weighted.py has been edited successfully.
Here's a snippet of the edited section:
   133	        # DataArray (if `weights` has additional dimensions)
   134	        # maybe add fasttrack (`(da * weights).sum(dims=dim, skipna=skipna)`)
   135	        return dot(da, weights, dims=dim)
   136	
   137	    def _sum_of_weights(
   138	        self, da: "DataArray", dim: Optional[Union[Hashable, Iterable[Hashable]]] = None
   139	    ) -> "DataArray":
   140	        """ Calculate the sum of weights, accounting for missing values """
   141	
   142	        # we need to mask data values that are nan; else the weights are wrong
   143	        mask = da.notnull()
   144	        
   145	        # Convert boolean weights to numeric type to avoid boolean dot product results
   146	        weights = self.weights
   147	        if weights.dtype == bool:
   148	            weights = weights * 1
   149	
   150	        sum_of_weights = self._reduce(mask, weights, dim=dim, skipna=False)
   151	
   152	        # 0-weights are not valid
   153	        valid_weights = sum_of_weights != 0.0
   154	
Review the changes and make sure they are as expected.


=== Iteration 20/100 ===
Calling LLM with timeout=600.0s...
LLM Response: Now let's test our fix by running the reproduction script again:

<function=execute_bash>
<parameter=command>python reproduce_issue.py</parameter>
</function>...
Executing tool: r2e_bash_executor
Tool parameters: {
  "command": "python reproduce_issue.py"
}
Tool execution status: success
Tool stdout:
[STDOUT]
Data array: [1. 1. 1.]
Weights array: [ True  True False]
Weights dtype: bool
Weighted mean result: 1.0
Expected result: 1.0
Result matches expected: True
Sum of weights: 2.0
Sum of weights dtype: float64
[STDERR]
/testbed/reproduce_issue.py:6: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  wgt = xr.DataArray(np.array([1, 1, 0], dtype=np.bool))


=== Iteration 21/100 ===
Calling LLM with timeout=600.0s...
LLM Response: Excellent! The fix works perfectly. The weighted mean now returns `1.0` instead of `2.0`, and the sum of weights is correctly `2.0` instead of `1.0`.

Let's also test some edge cases to make sure our ...
Executing tool: r2e_file_editor
Tool parameters: {
  "command": "create",
  "path": "test_edge_cases.py",
  "file_text": "import numpy as np\nimport xarray as xr\n\nprint(\"Testing edge cases for boolean weights fix:\")\n\n# Test 1: Original issue case\nprint(\"\\n1. Original issue case:\")\ndta = xr.DataArray([1., 1., 1.])\nwgt = xr.DataArray(np.array([1, 1, 0], dtype=bool))\nresult = dta.weighted(wgt).mean()\nprint(f\"Result: {result.values}, Expected: 1.0\")\n\n# Test 2: All weights True\nprint(\"\\n2. All weights True:\")\ndta = xr.DataArray([1., 2., 3.])\nwgt = xr.DataArray(np.array([1, 1, 1], dtype=bool))\nresult = dta.weighted(wgt).mean()\nprint(f\"Result: {result.values}, Expected: 2.0\")\n\n# Test 3: All weights False\nprint(\"\\n3. All weights False:\")\ndta = xr.DataArray([1., 2., 3.])\nwgt = xr.DataArray(np.array([0, 0, 0], dtype=bool))\nresult = dta.weighted(wgt).mean()\nprint(f\"Result: {result.values}, Expected: nan (should be handled by existing logic)\")\n\n# Test 4: Mixed numeric and boolean weights\nprint(\"\\n4. Numeric weights (should work as before):\")\ndta = xr.DataArray([1., 1., 1.])\nwgt = xr.DataArray([1, 1, 0], dtype=int)\nresult = dta.weighted(wgt).mean()\nprint(f\"Result: {result.values}, Expected: 1.0\")\n\n# Test 5: Float weights (should work as before)\nprint(\"\\n5. Float weights (should work as before):\")\ndta = xr.DataArray([1., 1., 1.])\nwgt = xr.DataArray([1.0, 1.0, 0.0], dtype=float)\nresult = dta.weighted(wgt).mean()\nprint(f\"Result: {result.values}, Expected: 1.0\")\n\n# Test 6: With NaN values in data\nprint(\"\\n6. With NaN values in data:\")\ndta = xr.DataArray([1., np.nan, 1.])\nwgt = xr.DataArray(np.array([1, 1, 0], dtype=bool))\nresult = dta.weighted(wgt).mean()\nprint(f\"Result: {result.values}, Expected: 1.0\")\n\nprint(\"\\nAll tests completed!\")"
}
Tool execution status: success
Tool stdout:
File created successfully at test_edge_cases.py.
Here's the result of running `cat -n` on test_edge_cases.py:
     1	import numpy as np
     2	import xarray as xr
     3	
     4	print("Testing edge cases for boolean weights fix:")
     5	
     6	# Test 1: Original issue case
     7	print("\n1. Original issue case:")
     8	dta = xr.DataArray([1., 1., 1.])
     9	wgt = xr.DataArray(np.array([1, 1, 0], dtype=bool))
    10	result = dta.weighted(wgt).mean()
    11	print(f"Result: {result.values}, Expected: 1.0")
    12	
    13	# Test 2: All weights True
    14	print("\n2. All weights True:")
    15	dta = xr.DataArray([1., 2., 3.])
    16	wgt = xr.DataArray(np.array([1, 1, 1], dtype=bool))
    17	result = dta.weighted(wgt).mean()
    18	print(f"Result: {result.values}, Expected: 2.0")
    19	
    20	# Test 3: All weights False
... (file continues)


=== Iteration 22/100 ===
Calling LLM with timeout=600.0s...
LLM Response: <function=execute_bash>
<parameter=command>python test_edge_cases.py</parameter>
</function>...
Executing tool: r2e_bash_executor
Tool parameters: {
  "command": "python test_edge_cases.py"
}
Tool execution status: error
Tool stdout:
[STDOUT]
Testing edge cases for boolean weights fix:

1. Original issue case:
Result: 1.0, Expected: 1.0

2. All weights True:
Result: 2.0, Expected: 2.0

3. All weights False:
Result: nan, Expected: nan (should be handled by existing logic)

4. Numeric weights (should work as before):
Error executing command:
Exit code: 1
[STDERR]
Traceback (most recent call last):
  File "/testbed/test_edge_cases.py", line 30, in <module>
    wgt = xr.DataArray([1, 1, 0], dtype=int)
TypeError: DataArray.__init__() got an unexpected keyword argument 'dtype'
command terminated with exit code 1


=== Iteration 23/100 ===
Calling LLM with timeout=600.0s...
LLM Response: Let me fix the test script:

<function=file_editor>
<parameter=command>str_replace</parameter>
<parameter=path>test_edge_cases.py</parameter>
<parameter=old_str># Test 4: Mixed numeric and boolean wei...
Executing tool: r2e_file_editor
Tool parameters: {
  "command": "str_replace",
  "path": "test_edge_cases.py",
  "old_str": "# Test 4: Mixed numeric and boolean weights\nprint(\"\\n4. Numeric weights (should work as before):\")\ndta = xr.DataArray([1., 1., 1.])\nwgt = xr.DataArray([1, 1, 0], dtype=int)\nresult = dta.weighted(wgt).mean()\nprint(f\"Result: {result.values}, Expected: 1.0\")\n\n# Test 5: Float weights (should work as before)\nprint(\"\\n5. Float weights (should work as before):\")\ndta = xr.DataArray([1., 1., 1.])\nwgt = xr.DataArray([1.0, 1.0, 0.0], dtype=float)\nresult = dta.weighted(wgt).mean()\nprint(f\"Result: {result.values}, Expected: 1.0\")",
  "new_str": "# Test 4: Mixed numeric and boolean weights\nprint(\"\\n4. Numeric weights (should work as before):\")\ndta = xr.DataArray([1., 1., 1.])\nwgt = xr.DataArray([1, 1, 0])\nresult = dta.weighted(wgt).mean()\nprint(f\"Result: {result.values}, Expected: 1.0\")\n\n# Test 5: Float weights (should work as before)\nprint(\"\\n5. Float weights (should work as before):\")\ndta = xr.DataArray([1., 1., 1.])\nwgt = xr.DataArray([1.0, 1.0, 0.0])\nresult = dta.weighted(wgt).mean()\nprint(f\"Result: {result.values}, Expected: 1.0\")"
}
Tool execution status: success
Tool stdout:
The file test_edge_cases.py has been edited successfully.
Here's a snippet of the edited section:
    23	wgt = xr.DataArray(np.array([0, 0, 0], dtype=bool))
    24	result = dta.weighted(wgt).mean()
    25	print(f"Result: {result.values}, Expected: nan (should be handled by existing logic)")
    26	
    27	# Test 4: Mixed numeric and boolean weights
    28	print("\n4. Numeric weights (should work as before):")
    29	dta = xr.DataArray([1., 1., 1.])
    30	wgt = xr.DataArray([1, 1, 0])
    31	result = dta.weighted(wgt).mean()
    32	print(f"Result: {result.values}, Expected: 1.0")
    33	
    34	# Test 5: Float weights (should work as before)
    35	print("\n5. Float weights (should work as before):")
    36	dta = xr.DataArray([1., 1., 1.])
    37	wgt = xr.DataArray([1.0, 1.0, 0.0])
    38	result = dta.weighted(wgt).mean()
    39	print(f"Result: {result.values}, Expected: 1.0")
    40	
    41	# Test 6: With NaN values in data
    42	print("\n6. With NaN values in data:")
    43	dta = xr.DataArray([1., np.nan, 1.])
Review the changes and make sure they are as expected.


=== Iteration 24/100 ===
Calling LLM with timeout=600.0s...
LLM Response:       <function=execute_bash>
<parameter=command>python test_edge_cases.py</parameter>
</function>...
Executing tool: r2e_bash_executor
Tool parameters: {
  "command": "python test_edge_cases.py"
}
Tool execution status: success
Tool stdout:
[STDOUT]
Testing edge cases for boolean weights fix:

1. Original issue case:
Result: 1.0, Expected: 1.0

2. All weights True:
Result: 2.0, Expected: 2.0

3. All weights False:
Result: nan, Expected: nan (should be handled by existing logic)

4. Numeric weights (should work as before):
Result: 1.0, Expected: 1.0

5. Float weights (should work as before):
Result: 1.0, Expected: 1.0

6. With NaN values in data:
Result: 1.0, Expected: 1.0

All tests completed!


=== Iteration 25/100 ===
Calling LLM with timeout=600.0s...
LLM Response:       Perfect! All the edge cases pass. Our fix correctly handles:

1. The original issue case
2. All weights True 
3. All weights False (returns NaN as expected by existing logic)
4. Numeric weights ...
Executing tool: r2e_bash_executor
Tool parameters: {
  "command": "python -m pytest xarray/tests/test_weighted.py -v"
}
Tool execution status: success
Tool stdout:
[STDOUT]
============================= test session starts ==============================
platform linux -- Python 3.10.16, pytest-7.4.0, pluggy-1.5.0 -- /root/.venv/bin/python
cachedir: .pytest_cache
hypothesis profile 'default' -> database=DirectoryBasedExampleDatabase(PosixPath('/testbed/.hypothesis/examples'))
rootdir: /testbed
configfile: setup.cfg
plugins: cov-6.0.0, xdist-3.6.1, env-1.1.5, hypothesis-6.123.2
collecting ... collected 960 items

xarray/tests/test_weighted.py::test_weighted_non_DataArray_weights[True] PASSED [  0%]
xarray/tests/test_weighted.py::test_weighted_non_DataArray_weights[False] PASSED [  0%]
xarray/tests/test_weighted.py::test_weighted_weights_nan_raises[weights0-True] PASSED [  0%]
xarray/tests/test_weighted.py::test_weighted_weights_nan_raises[weights0-False] PASSED [  0%]
xarray/tests/test_weighted.py::test_weighted_weights_nan_raises[weights1-True] PASSED [  0%]
xarray/tests/test_weighted.py::test_weighted_weights_nan_raises[weights1-False] PASSED [  0%]
xarray/tests/test_weighted.py::test_weighted_sum_of_weights_no_nan[weights0-3] PASSED [  0%]
xarray/tests/test_weighted.py::test_weighted_sum_of_weights_no_nan[weights1-2] PASSED [  0%]
xarray/tests/test_weighted.py::test_weighted_sum_of_weights_no_nan[weights2-nan] PASSED [  0%]
xarray/tests/test_weighted.py::test_weighted_sum_of_weights_no_nan[weights3-nan] PASSED [  1%]
xarray/tests/test_weighted.py::test_weighted_sum_of_weights_nan[weights0-2] PASSED [  1%]
xarray/tests/test_weighted.py::test_weighted_sum_of_weights_nan[weights1-nan] PASSED [  1%]
xarray/tests/test_weighted.py::test_weighted_sum_of_weights_nan[weights2-nan] PASSED [  1%]
xarray/tests/test_weighted.py::test_weighted_sum_of_weights_nan[weights3-1] PASSED [  1%]
xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[True-0-da0] PASSED [  1%]
xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[True-0-da1] PASSED [  1%]
xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[True-0-da2] PASSED [  1%]
xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[True-1-da0] PASSED [  1%]
xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[True-1-da1] PASSED [  1%]
xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[True-1-da2] PASSED [  2%]
xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[True-3.14-da0] PASSED [  2%]
xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[True-3.14-da1] PASSED [  2%]
xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[True-3.14-da2] PASSED [  2%]
xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[False-0-da0] PASSED [  2%]
xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[False-0-da1] PASSED [  2%]
xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[False-0-da2] PASSED [  2%]
xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[False-1-da0] PASSED [  2%]
xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[False-1-da1] PASSED [  2%]
xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[False-1-da2] PASSED [  3%]
xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[False-3.14-da0] PASSED [  3%]
xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[False-3.14-da1] PASSED [  3%]
xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[False-3.14-da2] PASSED [  3%]
xarray/tests/test_weighted.py::test_weighted_sum_no_nan[weights0-5] PASSED [  3%]
xarray/tests/test_weighted.py::test_weighted_sum_no_nan[weights1-4] PASSED [  3%]
xarray/tests/test_weighted.py::test_weighted_sum_no_nan[weights2-0] PASSED [  3%]
xarray/tests/test_weighted.py::test_weighted_sum_nan[True-weights0-4] PASSED [  3%]
xarray/tests/test_weighted.py::test_weighted_sum_nan[True-weights1-4] PASSED [  3%]
xarray/tests/test_weighted.py::test_weighted_sum_nan[True-weights2-0] PASSED [  3%]
xarray/tests/test_weighted.py::test_weighted_sum_nan[True-weights3-0] PASSED [  4%]
xarray/tests/test_weighted.py::test_weighted_sum_nan[False-weights0-4] PASSED [  4%]
xarray/tests/test_weighted.py::test_weighted_sum_nan[False-weights1-4] PASSED [  4%]
xarray/tests/test_weighted.py::test_weighted_sum_nan[False-weights2-0] PASSED [  4%]
xarray/tests/test_weighted.py::test_weighted_sum_nan[False-weights3-0] PASSED [  4%]
xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[1-True-da0] PASSED [  4%]
xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[1-True-da1] PASSED [  4%]
xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[1-True-da2] PASSED [  4%]
xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[1-False-da0] PASSED [  4%]
xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[1-False-da1] PASSED [  5%]
xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[1-False-da2] PASSED [  5%]
xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[2-True-da0] PASSED [  5%]
xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[2-True-da1] PASSED [  5%]
xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[2-True-da2] PASSED [  5%]
xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[2-False-da0] PASSED [  5%]
xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[2-False-da1] PASSED [  5%]
xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[2-False-da2] PASSED [  5%]
xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[3.14-True-da0] PASSED [  5%]
xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[3.14-True-da1] PASSED [  5%]
xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[3.14-True-da2] PASSED [  6%]
xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[3.14-False-da0] PASSED [  6%]
xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[3.14-False-da1] PASSED [  6%]
xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[3.14-False-da2] PASSED [  6%]
xarray/tests/test_weighted.py::test_weighted_mean_no_nan[weights0-1.6] PASSED [  6%]
xarray/tests/test_weighted.py::test_weighted_mean_no_nan[weights1-1.0] PASSED [  6%]
xarray/tests/test_weighted.py::test_weighted_mean_no_nan[weights2-nan] PASSED [  6%]
xarray/tests/test_weighted.py::test_weighted_mean_nan[True-weights0-2.0] PASSED [  6%]
xarray/tests/test_weighted.py::test_weighted_mean_nan[True-weights1-nan] PASSED [  6%]
xarray/tests/test_weighted.py::test_weighted_mean_nan[True-weights2-nan] PASSED [  6%]
xarray/tests/test_weighted.py::test_weighted_mean_nan[False-weights0-2.0] PASSED [  7%]
xarray/tests/test_weighted.py::test_weighted_mean_nan[False-weights1-nan] PASSED [  7%]
xarray/tests/test_weighted.py::test_weighted_mean_nan[False-weights2-nan] PASSED [  7%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-sum_of_weights-a] PASSED [  7%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-sum_of_weights-b] PASSED [  7%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-sum_of_weights-c] PASSED [  7%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-sum_of_weights-dim3] PASSED [  7%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-sum_of_weights-dim4] PASSED [  7%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-sum_of_weights-None] PASSED [  7%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-sum-a] PASSED [  8%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-sum-b] PASSED [  8%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-sum-c] PASSED [  8%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-sum-dim3] PASSED [  8%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-sum-dim4] PASSED [  8%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-sum-None] PASSED [  8%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-mean-a] PASSED [  8%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-mean-b] PASSED [  8%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-mean-c] PASSED [  8%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-mean-dim3] PASSED [  8%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-mean-dim4] PASSED [  9%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-mean-None] PASSED [  9%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-sum_of_weights-a] PASSED [  9%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-sum_of_weights-b] PASSED [  9%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-sum_of_weights-c] PASSED [  9%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-sum_of_weights-dim3] PASSED [  9%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-sum_of_weights-dim4] PASSED [  9%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-sum_of_weights-None] PASSED [  9%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-sum-a] PASSED [  9%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-sum-b] PASSED [ 10%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-sum-c] PASSED [ 10%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-sum-dim3] PASSED [ 10%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-sum-dim4] PASSED [ 10%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-sum-None] PASSED [ 10%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-mean-a] PASSED [ 10%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-mean-b] PASSED [ 10%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-mean-c] PASSED [ 10%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-mean-dim3] PASSED [ 10%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-mean-dim4] PASSED [ 10%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-mean-None] PASSED [ 11%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-sum_of_weights-a] PASSED [ 11%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-sum_of_weights-b] PASSED [ 11%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-sum_of_weights-c] PASSED [ 11%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-sum_of_weights-dim3] PASSED [ 11%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-sum_of_weights-dim4] PASSED [ 11%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-sum_of_weights-None] PASSED [ 11%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-sum-a] PASSED [ 11%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-sum-b] PASSED [ 11%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-sum-c] PASSED [ 11%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-sum-dim3] PASSED [ 12%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-sum-dim4] PASSED [ 12%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-sum-None] PASSED [ 12%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-mean-a] PASSED [ 12%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-mean-b] PASSED [ 12%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-mean-c] PASSED [ 12%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-mean-dim3] PASSED [ 12%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-mean-dim4] PASSED [ 12%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-mean-None] PASSED [ 12%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-sum_of_weights-a] PASSED [ 13%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-sum_of_weights-b] PASSED [ 13%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-sum_of_weights-c] PASSED [ 13%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-sum_of_weights-dim3] PASSED [ 13%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-sum_of_weights-dim4] PASSED [ 13%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-sum_of_weights-None] PASSED [ 13%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-sum-a] PASSED [ 13%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-sum-b] PASSED [ 13%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-sum-c] PASSED [ 13%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-sum-dim3] PASSED [ 13%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-sum-dim4] PASSED [ 14%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-sum-None] PASSED [ 14%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-mean-a] PASSED [ 14%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-mean-b] PASSED [ 14%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-mean-c] PASSED [ 14%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-mean-dim3] PASSED [ 14%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-mean-dim4] PASSED [ 14%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-mean-None] PASSED [ 14%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-sum_of_weights-a] PASSED [ 14%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-sum_of_weights-b] PASSED [ 15%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-sum_of_weights-c] PASSED [ 15%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-sum_of_weights-dim3] PASSED [ 15%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-sum_of_weights-dim4] PASSED [ 15%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-sum_of_weights-None] PASSED [ 15%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-sum-a] PASSED [ 15%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-sum-b] PASSED [ 15%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-sum-c] PASSED [ 15%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-sum-dim3] PASSED [ 15%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-sum-dim4] PASSED [ 15%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-sum-None] PASSED [ 16%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-mean-a] PASSED [ 16%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-mean-b] PASSED [ 16%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-mean-c] PASSED [ 16%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-mean-dim3] PASSED [ 16%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-mean-dim4] PASSED [ 16%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-mean-None] PASSED [ 16%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-sum_of_weights-a] PASSED [ 16%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-sum_of_weights-b] PASSED [ 16%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-sum_of_weights-c] PASSED [ 16%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-sum_of_weights-dim3] PASSED [ 17%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-sum_of_weights-dim4] PASSED [ 17%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-sum_of_weights-None] PASSED [ 17%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-sum-a] PASSED [ 17%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-sum-b] PASSED [ 17%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-sum-c] PASSED [ 17%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-sum-dim3] PASSED [ 17%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-sum-dim4] PASSED [ 17%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-sum-None] PASSED [ 17%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-mean-a] PASSED [ 18%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-mean-b] PASSED [ 18%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-mean-c] PASSED [ 18%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-mean-dim3] PASSED [ 18%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-mean-dim4] PASSED [ 18%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-mean-None] PASSED [ 18%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-sum_of_weights-a] PASSED [ 18%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-sum_of_weights-b] PASSED [ 18%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-sum_of_weights-c] PASSED [ 18%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-sum_of_weights-dim3] PASSED [ 18%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-sum_of_weights-dim4] PASSED [ 19%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-sum_of_weights-None] PASSED [ 19%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-sum-a] PASSED [ 19%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-sum-b] PASSED [ 19%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-sum-c] PASSED [ 19%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-sum-dim3] PASSED [ 19%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-sum-dim4] PASSED [ 19%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-sum-None] PASSED [ 19%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-mean-a] PASSED [ 19%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-mean-b] PASSED [ 20%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-mean-c] PASSED [ 20%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-mean-dim3] PASSED [ 20%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-mean-dim4] PASSED [ 20%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-mean-None] PASSED [ 20%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-sum_of_weights-a] PASSED [ 20%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-sum_of_weights-b] PASSED [ 20%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-sum_of_weights-c] PASSED [ 20%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-sum_of_weights-dim3] PASSED [ 20%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-sum_of_weights-dim4] PASSED [ 20%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-sum_of_weights-None] PASSED [ 21%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-sum-a] PASSED [ 21%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-sum-b] PASSED [ 21%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-sum-c] PASSED [ 21%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-sum-dim3] PASSED [ 21%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-sum-dim4] PASSED [ 21%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-sum-None] PASSED [ 21%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-mean-a] PASSED [ 21%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-mean-b] PASSED [ 21%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-mean-c] PASSED [ 21%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-mean-dim3] PASSED [ 22%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-mean-dim4] PASSED [ 22%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-mean-None] PASSED [ 22%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-sum_of_weights-a] PASSED [ 22%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-sum_of_weights-b] PASSED [ 22%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-sum_of_weights-c] PASSED [ 22%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-sum_of_weights-dim3] PASSED [ 22%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-sum_of_weights-dim4] PASSED [ 22%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-sum_of_weights-None] PASSED [ 22%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-sum-a] PASSED [ 23%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-sum-b] PASSED [ 23%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-sum-c] PASSED [ 23%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-sum-dim3] PASSED [ 23%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-sum-dim4] PASSED [ 23%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-sum-None] PASSED [ 23%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-mean-a] PASSED [ 23%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-mean-b] PASSED [ 23%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-mean-c] PASSED [ 23%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-mean-dim3] PASSED [ 23%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-mean-dim4] PASSED [ 24%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-mean-None] PASSED [ 24%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-sum_of_weights-a] PASSED [ 24%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-sum_of_weights-b] PASSED [ 24%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-sum_of_weights-c] PASSED [ 24%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-sum_of_weights-dim3] PASSED [ 24%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-sum_of_weights-dim4] PASSED [ 24%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-sum_of_weights-None] PASSED [ 24%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-sum-a] PASSED [ 24%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-sum-b] PASSED [ 25%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-sum-c] PASSED [ 25%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-sum-dim3] PASSED [ 25%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-sum-dim4] PASSED [ 25%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-sum-None] PASSED [ 25%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-mean-a] PASSED [ 25%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-mean-b] PASSED [ 25%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-mean-c] PASSED [ 25%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-mean-dim3] PASSED [ 25%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-mean-dim4] PASSED [ 25%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-mean-None] PASSED [ 26%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-sum_of_weights-a] PASSED [ 26%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-sum_of_weights-b] PASSED [ 26%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-sum_of_weights-c] PASSED [ 26%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-sum_of_weights-dim3] PASSED [ 26%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-sum_of_weights-dim4] PASSED [ 26%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-sum_of_weights-None] PASSED [ 26%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-sum-a] PASSED [ 26%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-sum-b] PASSED [ 26%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-sum-c] PASSED [ 26%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-sum-dim3] PASSED [ 27%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-sum-dim4] PASSED [ 27%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-sum-None] PASSED [ 27%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-mean-a] PASSED [ 27%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-mean-b] PASSED [ 27%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-mean-c] PASSED [ 27%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-mean-dim3] PASSED [ 27%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-mean-dim4] PASSED [ 27%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-mean-None] PASSED [ 27%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-sum_of_weights-a] PASSED [ 28%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-sum_of_weights-b] PASSED [ 28%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-sum_of_weights-c] PASSED [ 28%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-sum_of_weights-dim3] PASSED [ 28%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-sum_of_weights-dim4] PASSED [ 28%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-sum_of_weights-None] PASSED [ 28%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-sum-a] PASSED [ 28%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-sum-b] PASSED [ 28%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-sum-c] PASSED [ 28%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-sum-dim3] PASSED [ 28%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-sum-dim4] PASSED [ 29%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-sum-None] PASSED [ 29%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-mean-a] PASSED [ 29%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-mean-b] PASSED [ 29%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-mean-c] PASSED [ 29%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-mean-dim3] PASSED [ 29%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-mean-dim4] PASSED [ 29%]
xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-mean-None] PASSED [ 29%]
xarray/tests/test_weighted.py::test_weighted_operations_nonequal_coords[True-sum_of_weights] PASSED [ 29%]
xarray/tests/test_weighted.py::test_weighted_operations_nonequal_coords[True-sum] PASSED [ 30%]
xarray/tests/test_weighted.py::test_weighted_operations_nonequal_coords[True-mean] PASSED [ 30%]
xarray/tests/test_weighted.py::test_weighted_operations_nonequal_coords[False-sum_of_weights] PASSED [ 30%]
xarray/tests/test_weighted.py::test_weighted_operations_nonequal_coords[False-sum] PASSED [ 30%]
xarray/tests/test_weighted.py::test_weighted_operations_nonequal_coords[False-mean] PASSED [ 30%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights0-shape_data0-dim_0] PASSED [ 30%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights0-shape_data0-None] PASSED [ 30%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights0-shape_data1-dim_0] PASSED [ 30%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights0-shape_data1-None] PASSED [ 30%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights0-shape_data2-dim_0] PASSED [ 30%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights0-shape_data2-None] PASSED [ 31%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights1-shape_data0-dim_0] PASSED [ 31%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights1-shape_data0-None] PASSED [ 31%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights1-shape_data1-dim_0] PASSED [ 31%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights1-shape_data1-None] PASSED [ 31%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights1-shape_data2-dim_0] PASSED [ 31%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights1-shape_data2-None] PASSED [ 31%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights2-shape_data0-dim_0] PASSED [ 31%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights2-shape_data0-None] PASSED [ 31%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights2-shape_data1-dim_0] PASSED [ 31%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights2-shape_data1-None] PASSED [ 32%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights2-shape_data2-dim_0] PASSED [ 32%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights2-shape_data2-None] PASSED [ 32%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights0-shape_data0-dim_0] PASSED [ 32%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights0-shape_data0-None] PASSED [ 32%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights0-shape_data1-dim_0] PASSED [ 32%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights0-shape_data1-None] PASSED [ 32%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights0-shape_data2-dim_0] PASSED [ 32%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights0-shape_data2-None] PASSED [ 32%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights1-shape_data0-dim_0] PASSED [ 33%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights1-shape_data0-None] PASSED [ 33%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights1-shape_data1-dim_0] PASSED [ 33%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights1-shape_data1-None] PASSED [ 33%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights1-shape_data2-dim_0] PASSED [ 33%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights1-shape_data2-None] PASSED [ 33%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights2-shape_data0-dim_0] PASSED [ 33%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights2-shape_data0-None] PASSED [ 33%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights2-shape_data1-dim_0] PASSED [ 33%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights2-shape_data1-None] PASSED [ 33%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights2-shape_data2-dim_0] PASSED [ 34%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights2-shape_data2-None] PASSED [ 34%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights0-shape_data0-dim_0] PASSED [ 34%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights0-shape_data0-None] PASSED [ 34%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights0-shape_data1-dim_0] PASSED [ 34%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights0-shape_data1-None] PASSED [ 34%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights0-shape_data2-dim_0] PASSED [ 34%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights0-shape_data2-None] PASSED [ 34%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights1-shape_data0-dim_0] PASSED [ 34%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights1-shape_data0-None] PASSED [ 35%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights1-shape_data1-dim_0] PASSED [ 35%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights1-shape_data1-None] PASSED [ 35%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights1-shape_data2-dim_0] PASSED [ 35%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights1-shape_data2-None] PASSED [ 35%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights2-shape_data0-dim_0] PASSED [ 35%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights2-shape_data0-None] PASSED [ 35%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights2-shape_data1-dim_0] PASSED [ 35%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights2-shape_data1-None] PASSED [ 35%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights2-shape_data2-dim_0] PASSED [ 35%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights2-shape_data2-None] PASSED [ 36%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights0-shape_data0-dim_0] PASSED [ 36%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights0-shape_data0-None] PASSED [ 36%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights0-shape_data1-dim_0] PASSED [ 36%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights0-shape_data1-None] PASSED [ 36%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights0-shape_data2-dim_0] PASSED [ 36%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights0-shape_data2-None] PASSED [ 36%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights1-shape_data0-dim_0] PASSED [ 36%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights1-shape_data0-None] PASSED [ 36%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights1-shape_data1-dim_0] PASSED [ 36%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights1-shape_data1-None] PASSED [ 37%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights1-shape_data2-dim_0] PASSED [ 37%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights1-shape_data2-None] PASSED [ 37%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights2-shape_data0-dim_0] PASSED [ 37%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights2-shape_data0-None] PASSED [ 37%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights2-shape_data1-dim_0] PASSED [ 37%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights2-shape_data1-None] PASSED [ 37%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights2-shape_data2-dim_0] PASSED [ 37%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights2-shape_data2-None] PASSED [ 37%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights0-shape_data0-dim_0] PASSED [ 38%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights0-shape_data0-None] PASSED [ 38%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights0-shape_data1-dim_0] PASSED [ 38%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights0-shape_data1-None] PASSED [ 38%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights0-shape_data2-dim_0] PASSED [ 38%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights0-shape_data2-None] PASSED [ 38%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights1-shape_data0-dim_0] PASSED [ 38%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights1-shape_data0-None] PASSED [ 38%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights1-shape_data1-dim_0] PASSED [ 38%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights1-shape_data1-None] PASSED [ 38%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights1-shape_data2-dim_0] PASSED [ 39%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights1-shape_data2-None] PASSED [ 39%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights2-shape_data0-dim_0] PASSED [ 39%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights2-shape_data0-None] PASSED [ 39%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights2-shape_data1-dim_0] PASSED [ 39%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights2-shape_data1-None] PASSED [ 39%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights2-shape_data2-dim_0] PASSED [ 39%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights2-shape_data2-None] PASSED [ 39%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights0-shape_data0-dim_0] PASSED [ 39%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights0-shape_data0-None] PASSED [ 40%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights0-shape_data1-dim_0] PASSED [ 40%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights0-shape_data1-None] PASSED [ 40%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights0-shape_data2-dim_0] PASSED [ 40%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights0-shape_data2-None] PASSED [ 40%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights1-shape_data0-dim_0] PASSED [ 40%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights1-shape_data0-None] PASSED [ 40%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights1-shape_data1-dim_0] PASSED [ 40%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights1-shape_data1-None] PASSED [ 40%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights1-shape_data2-dim_0] PASSED [ 40%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights1-shape_data2-None] PASSED [ 41%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights2-shape_data0-dim_0] PASSED [ 41%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights2-shape_data0-None] PASSED [ 41%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights2-shape_data1-dim_0] PASSED [ 41%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights2-shape_data1-None] PASSED [ 41%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights2-shape_data2-dim_0] PASSED [ 41%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights2-shape_data2-None] PASSED [ 41%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights0-shape_data0-dim_0] PASSED [ 41%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights0-shape_data0-None] PASSED [ 41%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights0-shape_data1-dim_0] PASSED [ 41%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights0-shape_data1-None] PASSED [ 42%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights0-shape_data2-dim_0] PASSED [ 42%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights0-shape_data2-None] PASSED [ 42%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights1-shape_data0-dim_0] PASSED [ 42%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights1-shape_data0-None] PASSED [ 42%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights1-shape_data1-dim_0] PASSED [ 42%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights1-shape_data1-None] PASSED [ 42%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights1-shape_data2-dim_0] PASSED [ 42%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights1-shape_data2-None] PASSED [ 42%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights2-shape_data0-dim_0] PASSED [ 43%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights2-shape_data0-None] PASSED [ 43%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights2-shape_data1-dim_0] PASSED [ 43%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights2-shape_data1-None] PASSED [ 43%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights2-shape_data2-dim_0] PASSED [ 43%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights2-shape_data2-None] PASSED [ 43%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights0-shape_data0-dim_0] PASSED [ 43%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights0-shape_data0-None] PASSED [ 43%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights0-shape_data1-dim_0] PASSED [ 43%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights0-shape_data1-None] PASSED [ 43%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights0-shape_data2-dim_0] PASSED [ 44%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights0-shape_data2-None] PASSED [ 44%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights1-shape_data0-dim_0] PASSED [ 44%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights1-shape_data0-None] PASSED [ 44%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights1-shape_data1-dim_0] PASSED [ 44%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights1-shape_data1-None] PASSED [ 44%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights1-shape_data2-dim_0] PASSED [ 44%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights1-shape_data2-None] PASSED [ 44%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights2-shape_data0-dim_0] PASSED [ 44%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights2-shape_data0-None] PASSED [ 45%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights2-shape_data1-dim_0] PASSED [ 45%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights2-shape_data1-None] PASSED [ 45%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights2-shape_data2-dim_0] PASSED [ 45%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights2-shape_data2-None] PASSED [ 45%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights0-shape_data0-dim_0] PASSED [ 45%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights0-shape_data0-None] PASSED [ 45%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights0-shape_data1-dim_0] PASSED [ 45%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights0-shape_data1-None] PASSED [ 45%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights0-shape_data2-dim_0] PASSED [ 45%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights0-shape_data2-None] PASSED [ 46%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights1-shape_data0-dim_0] PASSED [ 46%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights1-shape_data0-None] PASSED [ 46%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights1-shape_data1-dim_0] PASSED [ 46%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights1-shape_data1-None] PASSED [ 46%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights1-shape_data2-dim_0] PASSED [ 46%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights1-shape_data2-None] PASSED [ 46%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights2-shape_data0-dim_0] PASSED [ 46%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights2-shape_data0-None] PASSED [ 46%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights2-shape_data1-dim_0] PASSED [ 46%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights2-shape_data1-None] PASSED [ 47%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights2-shape_data2-dim_0] PASSED [ 47%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights2-shape_data2-None] PASSED [ 47%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights0-shape_data0-dim_0] PASSED [ 47%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights0-shape_data0-None] PASSED [ 47%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights0-shape_data1-dim_0] PASSED [ 47%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights0-shape_data1-None] PASSED [ 47%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights0-shape_data2-dim_0] PASSED [ 47%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights0-shape_data2-None] PASSED [ 47%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights1-shape_data0-dim_0] PASSED [ 48%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights1-shape_data0-None] PASSED [ 48%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights1-shape_data1-dim_0] PASSED [ 48%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights1-shape_data1-None] PASSED [ 48%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights1-shape_data2-dim_0] PASSED [ 48%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights1-shape_data2-None] PASSED [ 48%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights2-shape_data0-dim_0] PASSED [ 48%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights2-shape_data0-None] PASSED [ 48%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights2-shape_data1-dim_0] PASSED [ 48%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights2-shape_data1-None] PASSED [ 48%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights2-shape_data2-dim_0] PASSED [ 49%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights2-shape_data2-None] PASSED [ 49%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights0-shape_data0-dim_0] PASSED [ 49%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights0-shape_data0-None] PASSED [ 49%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights0-shape_data1-dim_0] PASSED [ 49%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights0-shape_data1-None] PASSED [ 49%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights0-shape_data2-dim_0] PASSED [ 49%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights0-shape_data2-None] PASSED [ 49%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights1-shape_data0-dim_0] PASSED [ 49%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights1-shape_data0-None] PASSED [ 50%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights1-shape_data1-dim_0] PASSED [ 50%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights1-shape_data1-None] PASSED [ 50%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights1-shape_data2-dim_0] PASSED [ 50%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights1-shape_data2-None] PASSED [ 50%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights2-shape_data0-dim_0] PASSED [ 50%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights2-shape_data0-None] PASSED [ 50%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights2-shape_data1-dim_0] PASSED [ 50%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights2-shape_data1-None] PASSED [ 50%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights2-shape_data2-dim_0] PASSED [ 50%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights2-shape_data2-None] PASSED [ 51%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights0-shape_data0-dim_0] PASSED [ 51%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights0-shape_data0-None] PASSED [ 51%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights0-shape_data1-dim_0] PASSED [ 51%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights0-shape_data1-None] PASSED [ 51%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights0-shape_data2-dim_0] PASSED [ 51%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights0-shape_data2-None] PASSED [ 51%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights1-shape_data0-dim_0] PASSED [ 51%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights1-shape_data0-None] PASSED [ 51%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights1-shape_data1-dim_0] PASSED [ 51%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights1-shape_data1-None] PASSED [ 52%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights1-shape_data2-dim_0] PASSED [ 52%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights1-shape_data2-None] PASSED [ 52%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights2-shape_data0-dim_0] PASSED [ 52%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights2-shape_data0-None] PASSED [ 52%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights2-shape_data1-dim_0] PASSED [ 52%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights2-shape_data1-None] PASSED [ 52%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights2-shape_data2-dim_0] PASSED [ 52%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights2-shape_data2-None] PASSED [ 52%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights0-shape_data0-dim_0] PASSED [ 53%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights0-shape_data0-None] PASSED [ 53%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights0-shape_data1-dim_0] PASSED [ 53%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights0-shape_data1-None] PASSED [ 53%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights0-shape_data2-dim_0] PASSED [ 53%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights0-shape_data2-None] PASSED [ 53%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights1-shape_data0-dim_0] PASSED [ 53%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights1-shape_data0-None] PASSED [ 53%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights1-shape_data1-dim_0] PASSED [ 53%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights1-shape_data1-None] PASSED [ 53%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights1-shape_data2-dim_0] PASSED [ 54%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights1-shape_data2-None] PASSED [ 54%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights2-shape_data0-dim_0] PASSED [ 54%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights2-shape_data0-None] PASSED [ 54%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights2-shape_data1-dim_0] PASSED [ 54%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights2-shape_data1-None] PASSED [ 54%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights2-shape_data2-dim_0] PASSED [ 54%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights2-shape_data2-None] PASSED [ 54%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights0-shape_data0-dim_0] PASSED [ 54%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights0-shape_data0-None] PASSED [ 55%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights0-shape_data1-dim_0] PASSED [ 55%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights0-shape_data1-None] PASSED [ 55%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights0-shape_data2-dim_0] PASSED [ 55%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights0-shape_data2-None] PASSED [ 55%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights1-shape_data0-dim_0] PASSED [ 55%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights1-shape_data0-None] PASSED [ 55%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights1-shape_data1-dim_0] PASSED [ 55%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights1-shape_data1-None] PASSED [ 55%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights1-shape_data2-dim_0] PASSED [ 55%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights1-shape_data2-None] PASSED [ 56%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights2-shape_data0-dim_0] PASSED [ 56%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights2-shape_data0-None] PASSED [ 56%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights2-shape_data1-dim_0] PASSED [ 56%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights2-shape_data1-None] PASSED [ 56%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights2-shape_data2-dim_0] PASSED [ 56%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights2-shape_data2-None] PASSED [ 56%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights0-shape_data0-dim_0] PASSED [ 56%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights0-shape_data0-None] PASSED [ 56%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights0-shape_data1-dim_0] PASSED [ 56%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights0-shape_data1-None] PASSED [ 57%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights0-shape_data2-dim_0] PASSED [ 57%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights0-shape_data2-None] PASSED [ 57%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights1-shape_data0-dim_0] PASSED [ 57%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights1-shape_data0-None] PASSED [ 57%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights1-shape_data1-dim_0] PASSED [ 57%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights1-shape_data1-None] PASSED [ 57%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights1-shape_data2-dim_0] PASSED [ 57%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights1-shape_data2-None] PASSED [ 57%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights2-shape_data0-dim_0] PASSED [ 58%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights2-shape_data0-None] PASSED [ 58%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights2-shape_data1-dim_0] PASSED [ 58%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights2-shape_data1-None] PASSED [ 58%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights2-shape_data2-dim_0] PASSED [ 58%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights2-shape_data2-None] PASSED [ 58%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights0-shape_data0-dim_0] PASSED [ 58%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights0-shape_data0-None] PASSED [ 58%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights0-shape_data1-dim_0] PASSED [ 58%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights0-shape_data1-None] PASSED [ 58%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights0-shape_data2-dim_0] PASSED [ 59%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights0-shape_data2-None] PASSED [ 59%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights1-shape_data0-dim_0] PASSED [ 59%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights1-shape_data0-None] PASSED [ 59%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights1-shape_data1-dim_0] PASSED [ 59%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights1-shape_data1-None] PASSED [ 59%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights1-shape_data2-dim_0] PASSED [ 59%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights1-shape_data2-None] PASSED [ 59%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights2-shape_data0-dim_0] PASSED [ 59%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights2-shape_data0-None] PASSED [ 60%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights2-shape_data1-dim_0] PASSED [ 60%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights2-shape_data1-None] PASSED [ 60%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights2-shape_data2-dim_0] PASSED [ 60%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights2-shape_data2-None] PASSED [ 60%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights0-shape_data0-dim_0] PASSED [ 60%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights0-shape_data0-None] PASSED [ 60%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights0-shape_data1-dim_0] PASSED [ 60%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights0-shape_data1-None] PASSED [ 60%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights0-shape_data2-dim_0] PASSED [ 60%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights0-shape_data2-None] PASSED [ 61%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights1-shape_data0-dim_0] PASSED [ 61%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights1-shape_data0-None] PASSED [ 61%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights1-shape_data1-dim_0] PASSED [ 61%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights1-shape_data1-None] PASSED [ 61%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights1-shape_data2-dim_0] PASSED [ 61%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights1-shape_data2-None] PASSED [ 61%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights2-shape_data0-dim_0] PASSED [ 61%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights2-shape_data0-None] PASSED [ 61%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights2-shape_data1-dim_0] PASSED [ 61%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights2-shape_data1-None] PASSED [ 62%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights2-shape_data2-dim_0] PASSED [ 62%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights2-shape_data2-None] PASSED [ 62%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights0-shape_data0-dim_0] PASSED [ 62%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights0-shape_data0-None] PASSED [ 62%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights0-shape_data1-dim_0] PASSED [ 62%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights0-shape_data1-None] PASSED [ 62%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights0-shape_data2-dim_0] PASSED [ 62%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights0-shape_data2-None] PASSED [ 62%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights1-shape_data0-dim_0] PASSED [ 63%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights1-shape_data0-None] PASSED [ 63%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights1-shape_data1-dim_0] PASSED [ 63%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights1-shape_data1-None] PASSED [ 63%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights1-shape_data2-dim_0] PASSED [ 63%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights1-shape_data2-None] PASSED [ 63%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights2-shape_data0-dim_0] PASSED [ 63%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights2-shape_data0-None] PASSED [ 63%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights2-shape_data1-dim_0] PASSED [ 63%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights2-shape_data1-None] PASSED [ 63%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights2-shape_data2-dim_0] PASSED [ 64%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights2-shape_data2-None] PASSED [ 64%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights0-shape_data0-dim_0] PASSED [ 64%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights0-shape_data0-None] PASSED [ 64%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights0-shape_data1-dim_0] PASSED [ 64%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights0-shape_data1-None] PASSED [ 64%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights0-shape_data2-dim_0] PASSED [ 64%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights0-shape_data2-None] PASSED [ 64%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights1-shape_data0-dim_0] PASSED [ 64%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights1-shape_data0-None] PASSED [ 65%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights1-shape_data1-dim_0] PASSED [ 65%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights1-shape_data1-None] PASSED [ 65%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights1-shape_data2-dim_0] PASSED [ 65%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights1-shape_data2-None] PASSED [ 65%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights2-shape_data0-dim_0] PASSED [ 65%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights2-shape_data0-None] PASSED [ 65%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights2-shape_data1-dim_0] PASSED [ 65%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights2-shape_data1-None] PASSED [ 65%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights2-shape_data2-dim_0] PASSED [ 65%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights2-shape_data2-None] PASSED [ 66%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights0-shape_data0-dim_0] PASSED [ 66%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights0-shape_data0-None] PASSED [ 66%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights0-shape_data1-dim_0] PASSED [ 66%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights0-shape_data1-None] PASSED [ 66%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights0-shape_data2-dim_0] PASSED [ 66%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights0-shape_data2-None] PASSED [ 66%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights1-shape_data0-dim_0] PASSED [ 66%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights1-shape_data0-None] PASSED [ 66%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights1-shape_data1-dim_0] PASSED [ 66%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights1-shape_data1-None] PASSED [ 67%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights1-shape_data2-dim_0] PASSED [ 67%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights1-shape_data2-None] PASSED [ 67%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights2-shape_data0-dim_0] PASSED [ 67%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights2-shape_data0-None] PASSED [ 67%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights2-shape_data1-dim_0] PASSED [ 67%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights2-shape_data1-None] PASSED [ 67%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights2-shape_data2-dim_0] PASSED [ 67%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights2-shape_data2-None] PASSED [ 67%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights0-shape_data0-dim_0] PASSED [ 68%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights0-shape_data0-None] PASSED [ 68%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights0-shape_data1-dim_0] PASSED [ 68%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights0-shape_data1-None] PASSED [ 68%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights0-shape_data2-dim_0] PASSED [ 68%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights0-shape_data2-None] PASSED [ 68%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights1-shape_data0-dim_0] PASSED [ 68%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights1-shape_data0-None] PASSED [ 68%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights1-shape_data1-dim_0] PASSED [ 68%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights1-shape_data1-None] PASSED [ 68%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights1-shape_data2-dim_0] PASSED [ 69%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights1-shape_data2-None] PASSED [ 69%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights2-shape_data0-dim_0] PASSED [ 69%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights2-shape_data0-None] PASSED [ 69%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights2-shape_data1-dim_0] PASSED [ 69%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights2-shape_data1-None] PASSED [ 69%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights2-shape_data2-dim_0] PASSED [ 69%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights2-shape_data2-None] PASSED [ 69%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights0-shape_data0-dim_0] PASSED [ 69%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights0-shape_data0-None] PASSED [ 70%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights0-shape_data1-dim_0] PASSED [ 70%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights0-shape_data1-None] PASSED [ 70%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights0-shape_data2-dim_0] PASSED [ 70%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights0-shape_data2-None] PASSED [ 70%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights1-shape_data0-dim_0] PASSED [ 70%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights1-shape_data0-None] PASSED [ 70%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights1-shape_data1-dim_0] PASSED [ 70%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights1-shape_data1-None] PASSED [ 70%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights1-shape_data2-dim_0] PASSED [ 70%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights1-shape_data2-None] PASSED [ 71%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights2-shape_data0-dim_0] PASSED [ 71%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights2-shape_data0-None] PASSED [ 71%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights2-shape_data1-dim_0] PASSED [ 71%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights2-shape_data1-None] PASSED [ 71%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights2-shape_data2-dim_0] PASSED [ 71%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights2-shape_data2-None] PASSED [ 71%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights0-shape_data0-dim_0] PASSED [ 71%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights0-shape_data0-None] PASSED [ 71%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights0-shape_data1-dim_0] PASSED [ 71%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights0-shape_data1-None] PASSED [ 72%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights0-shape_data2-dim_0] PASSED [ 72%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights0-shape_data2-None] PASSED [ 72%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights1-shape_data0-dim_0] PASSED [ 72%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights1-shape_data0-None] PASSED [ 72%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights1-shape_data1-dim_0] PASSED [ 72%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights1-shape_data1-None] PASSED [ 72%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights1-shape_data2-dim_0] PASSED [ 72%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights1-shape_data2-None] PASSED [ 72%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights2-shape_data0-dim_0] PASSED [ 73%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights2-shape_data0-None] PASSED [ 73%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights2-shape_data1-dim_0] PASSED [ 73%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights2-shape_data1-None] PASSED [ 73%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights2-shape_data2-dim_0] PASSED [ 73%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights2-shape_data2-None] PASSED [ 73%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights0-shape_data0-dim_0] PASSED [ 73%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights0-shape_data0-None] PASSED [ 73%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights0-shape_data1-dim_0] PASSED [ 73%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights0-shape_data1-None] PASSED [ 73%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights0-shape_data2-dim_0] PASSED [ 74%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights0-shape_data2-None] PASSED [ 74%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights1-shape_data0-dim_0] PASSED [ 74%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights1-shape_data0-None] PASSED [ 74%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights1-shape_data1-dim_0] PASSED [ 74%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights1-shape_data1-None] PASSED [ 74%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights1-shape_data2-dim_0] PASSED [ 74%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights1-shape_data2-None] PASSED [ 74%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights2-shape_data0-dim_0] PASSED [ 74%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights2-shape_data0-None] PASSED [ 75%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights2-shape_data1-dim_0] PASSED [ 75%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights2-shape_data1-None] PASSED [ 75%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights2-shape_data2-dim_0] PASSED [ 75%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights2-shape_data2-None] PASSED [ 75%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights0-shape_data0-dim_0] PASSED [ 75%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights0-shape_data0-None] PASSED [ 75%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights0-shape_data1-dim_0] PASSED [ 75%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights0-shape_data1-None] PASSED [ 75%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights0-shape_data2-dim_0] PASSED [ 75%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights0-shape_data2-None] PASSED [ 76%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights1-shape_data0-dim_0] PASSED [ 76%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights1-shape_data0-None] PASSED [ 76%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights1-shape_data1-dim_0] PASSED [ 76%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights1-shape_data1-None] PASSED [ 76%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights1-shape_data2-dim_0] PASSED [ 76%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights1-shape_data2-None] PASSED [ 76%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights2-shape_data0-dim_0] PASSED [ 76%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights2-shape_data0-None] PASSED [ 76%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights2-shape_data1-dim_0] PASSED [ 76%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights2-shape_data1-None] PASSED [ 77%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights2-shape_data2-dim_0] PASSED [ 77%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights2-shape_data2-None] PASSED [ 77%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights0-shape_data0-dim_0] PASSED [ 77%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights0-shape_data0-None] PASSED [ 77%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights0-shape_data1-dim_0] PASSED [ 77%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights0-shape_data1-None] PASSED [ 77%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights0-shape_data2-dim_0] PASSED [ 77%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights0-shape_data2-None] PASSED [ 77%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights1-shape_data0-dim_0] PASSED [ 78%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights1-shape_data0-None] PASSED [ 78%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights1-shape_data1-dim_0] PASSED [ 78%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights1-shape_data1-None] PASSED [ 78%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights1-shape_data2-dim_0] PASSED [ 78%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights1-shape_data2-None] PASSED [ 78%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights2-shape_data0-dim_0] PASSED [ 78%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights2-shape_data0-None] PASSED [ 78%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights2-shape_data1-dim_0] PASSED [ 78%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights2-shape_data1-None] PASSED [ 78%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights2-shape_data2-dim_0] PASSED [ 79%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights2-shape_data2-None] PASSED [ 79%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights0-shape_data0-dim_0] PASSED [ 79%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights0-shape_data0-None] PASSED [ 79%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights0-shape_data1-dim_0] PASSED [ 79%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights0-shape_data1-None] PASSED [ 79%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights0-shape_data2-dim_0] PASSED [ 79%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights0-shape_data2-None] PASSED [ 79%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights1-shape_data0-dim_0] PASSED [ 79%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights1-shape_data0-None] PASSED [ 80%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights1-shape_data1-dim_0] PASSED [ 80%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights1-shape_data1-None] PASSED [ 80%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights1-shape_data2-dim_0] PASSED [ 80%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights1-shape_data2-None] PASSED [ 80%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights2-shape_data0-dim_0] PASSED [ 80%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights2-shape_data0-None] PASSED [ 80%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights2-shape_data1-dim_0] PASSED [ 80%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights2-shape_data1-None] PASSED [ 80%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights2-shape_data2-dim_0] PASSED [ 80%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights2-shape_data2-None] PASSED [ 81%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights0-shape_data0-dim_0] PASSED [ 81%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights0-shape_data0-None] PASSED [ 81%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights0-shape_data1-dim_0] PASSED [ 81%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights0-shape_data1-None] PASSED [ 81%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights0-shape_data2-dim_0] PASSED [ 81%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights0-shape_data2-None] PASSED [ 81%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights1-shape_data0-dim_0] PASSED [ 81%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights1-shape_data0-None] PASSED [ 81%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights1-shape_data1-dim_0] PASSED [ 81%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights1-shape_data1-None] PASSED [ 82%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights1-shape_data2-dim_0] PASSED [ 82%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights1-shape_data2-None] PASSED [ 82%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights2-shape_data0-dim_0] PASSED [ 82%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights2-shape_data0-None] PASSED [ 82%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights2-shape_data1-dim_0] PASSED [ 82%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights2-shape_data1-None] PASSED [ 82%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights2-shape_data2-dim_0] PASSED [ 82%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights2-shape_data2-None] PASSED [ 82%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights0-shape_data0-dim_0] PASSED [ 83%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights0-shape_data0-None] PASSED [ 83%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights0-shape_data1-dim_0] PASSED [ 83%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights0-shape_data1-None] PASSED [ 83%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights0-shape_data2-dim_0] PASSED [ 83%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights0-shape_data2-None] PASSED [ 83%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights1-shape_data0-dim_0] PASSED [ 83%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights1-shape_data0-None] PASSED [ 83%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights1-shape_data1-dim_0] PASSED [ 83%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights1-shape_data1-None] PASSED [ 83%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights1-shape_data2-dim_0] PASSED [ 84%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights1-shape_data2-None] PASSED [ 84%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights2-shape_data0-dim_0] PASSED [ 84%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights2-shape_data0-None] PASSED [ 84%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights2-shape_data1-dim_0] PASSED [ 84%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights2-shape_data1-None] PASSED [ 84%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights2-shape_data2-dim_0] PASSED [ 84%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights2-shape_data2-None] PASSED [ 84%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights0-shape_data0-dim_0] PASSED [ 84%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights0-shape_data0-None] PASSED [ 85%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights0-shape_data1-dim_0] PASSED [ 85%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights0-shape_data1-None] PASSED [ 85%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights0-shape_data2-dim_0] PASSED [ 85%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights0-shape_data2-None] PASSED [ 85%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights1-shape_data0-dim_0] PASSED [ 85%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights1-shape_data0-None] PASSED [ 85%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights1-shape_data1-dim_0] PASSED [ 85%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights1-shape_data1-None] PASSED [ 85%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights1-shape_data2-dim_0] PASSED [ 85%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights1-shape_data2-None] PASSED [ 86%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights2-shape_data0-dim_0] PASSED [ 86%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights2-shape_data0-None] PASSED [ 86%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights2-shape_data1-dim_0] PASSED [ 86%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights2-shape_data1-None] PASSED [ 86%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights2-shape_data2-dim_0] PASSED [ 86%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights2-shape_data2-None] PASSED [ 86%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights0-shape_data0-dim_0] PASSED [ 86%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights0-shape_data0-None] PASSED [ 86%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights0-shape_data1-dim_0] PASSED [ 86%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights0-shape_data1-None] PASSED [ 87%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights0-shape_data2-dim_0] PASSED [ 87%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights0-shape_data2-None] PASSED [ 87%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights1-shape_data0-dim_0] PASSED [ 87%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights1-shape_data0-None] PASSED [ 87%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights1-shape_data1-dim_0] PASSED [ 87%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights1-shape_data1-None] PASSED [ 87%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights1-shape_data2-dim_0] PASSED [ 87%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights1-shape_data2-None] PASSED [ 87%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights2-shape_data0-dim_0] PASSED [ 88%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights2-shape_data0-None] PASSED [ 88%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights2-shape_data1-dim_0] PASSED [ 88%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights2-shape_data1-None] PASSED [ 88%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights2-shape_data2-dim_0] PASSED [ 88%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights2-shape_data2-None] PASSED [ 88%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights0-shape_data0-dim_0] PASSED [ 88%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights0-shape_data0-None] PASSED [ 88%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights0-shape_data1-dim_0] PASSED [ 88%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights0-shape_data1-None] PASSED [ 88%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights0-shape_data2-dim_0] PASSED [ 89%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights0-shape_data2-None] PASSED [ 89%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights1-shape_data0-dim_0] PASSED [ 89%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights1-shape_data0-None] PASSED [ 89%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights1-shape_data1-dim_0] PASSED [ 89%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights1-shape_data1-None] PASSED [ 89%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights1-shape_data2-dim_0] PASSED [ 89%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights1-shape_data2-None] PASSED [ 89%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights2-shape_data0-dim_0] PASSED [ 89%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights2-shape_data0-None] PASSED [ 90%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights2-shape_data1-dim_0] PASSED [ 90%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights2-shape_data1-None] PASSED [ 90%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights2-shape_data2-dim_0] PASSED [ 90%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights2-shape_data2-None] PASSED [ 90%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights0-shape_data0-dim_0] PASSED [ 90%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights0-shape_data0-None] PASSED [ 90%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights0-shape_data1-dim_0] PASSED [ 90%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights0-shape_data1-None] PASSED [ 90%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights0-shape_data2-dim_0] PASSED [ 90%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights0-shape_data2-None] PASSED [ 91%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights1-shape_data0-dim_0] PASSED [ 91%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights1-shape_data0-None] PASSED [ 91%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights1-shape_data1-dim_0] PASSED [ 91%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights1-shape_data1-None] PASSED [ 91%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights1-shape_data2-dim_0] PASSED [ 91%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights1-shape_data2-None] PASSED [ 91%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights2-shape_data0-dim_0] PASSED [ 91%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights2-shape_data0-None] PASSED [ 91%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights2-shape_data1-dim_0] PASSED [ 91%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights2-shape_data1-None] PASSED [ 92%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights2-shape_data2-dim_0] PASSED [ 92%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights2-shape_data2-None] PASSED [ 92%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights0-shape_data0-dim_0] PASSED [ 92%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights0-shape_data0-None] PASSED [ 92%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights0-shape_data1-dim_0] PASSED [ 92%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights0-shape_data1-None] PASSED [ 92%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights0-shape_data2-dim_0] PASSED [ 92%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights0-shape_data2-None] PASSED [ 92%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights1-shape_data0-dim_0] PASSED [ 93%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights1-shape_data0-None] PASSED [ 93%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights1-shape_data1-dim_0] PASSED [ 93%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights1-shape_data1-None] PASSED [ 93%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights1-shape_data2-dim_0] PASSED [ 93%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights1-shape_data2-None] PASSED [ 93%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights2-shape_data0-dim_0] PASSED [ 93%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights2-shape_data0-None] PASSED [ 93%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights2-shape_data1-dim_0] PASSED [ 93%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights2-shape_data1-None] PASSED [ 93%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights2-shape_data2-dim_0] PASSED [ 94%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights2-shape_data2-None] PASSED [ 94%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights0-shape_data0-dim_0] PASSED [ 94%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights0-shape_data0-None] PASSED [ 94%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights0-shape_data1-dim_0] PASSED [ 94%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights0-shape_data1-None] PASSED [ 94%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights0-shape_data2-dim_0] PASSED [ 94%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights0-shape_data2-None] PASSED [ 94%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights1-shape_data0-dim_0] PASSED [ 94%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights1-shape_data0-None] PASSED [ 95%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights1-shape_data1-dim_0] PASSED [ 95%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights1-shape_data1-None] PASSED [ 95%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights1-shape_data2-dim_0] PASSED [ 95%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights1-shape_data2-None] PASSED [ 95%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights2-shape_data0-dim_0] PASSED [ 95%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights2-shape_data0-None] PASSED [ 95%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights2-shape_data1-dim_0] PASSED [ 95%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights2-shape_data1-None] PASSED [ 95%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights2-shape_data2-dim_0] PASSED [ 95%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights2-shape_data2-None] PASSED [ 96%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights0-shape_data0-dim_0] PASSED [ 96%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights0-shape_data0-None] PASSED [ 96%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights0-shape_data1-dim_0] PASSED [ 96%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights0-shape_data1-None] PASSED [ 96%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights0-shape_data2-dim_0] PASSED [ 96%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights0-shape_data2-None] PASSED [ 96%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights1-shape_data0-dim_0] PASSED [ 96%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights1-shape_data0-None] PASSED [ 96%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights1-shape_data1-dim_0] PASSED [ 96%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights1-shape_data1-None] PASSED [ 97%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights1-shape_data2-dim_0] PASSED [ 97%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights1-shape_data2-None] PASSED [ 97%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights2-shape_data0-dim_0] PASSED [ 97%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights2-shape_data0-None] PASSED [ 97%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights2-shape_data1-dim_0] PASSED [ 97%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights2-shape_data1-None] PASSED [ 97%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights2-shape_data2-dim_0] PASSED [ 97%]
xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights2-shape_data2-None] PASSED [ 97%]
xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[True-True-sum_of_weights] PASSED [ 98%]
xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[True-True-sum] PASSED [ 98%]
xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[True-True-mean] PASSED [ 98%]
xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[True-False-sum_of_weights] PASSED [ 98%]
xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[True-False-sum] PASSED [ 98%]
xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[True-False-mean] PASSED [ 98%]
xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[False-True-sum_of_weights] PASSED [ 98%]
xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[False-True-sum] PASSED [ 98%]
xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[False-True-mean] PASSED [ 98%]
xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[False-False-sum_of_weights] PASSED [ 98%]
xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[False-False-sum] PASSED [ 99%]
xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[False-False-mean] PASSED [ 99%]
xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[None-True-sum_of_weights] PASSED [ 99%]
xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[None-True-sum] PASSED [ 99%]
xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[None-True-mean] PASSED [ 99%]
xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[None-False-sum_of_weights] PASSED [ 99%]
xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[None-False-sum] PASSED [ 99%]
xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[None-False-mean] PASSED [ 99%]
xarray/tests/test_weighted.py::test_weighted_operations_keep_attr_da_in_ds[sum] XFAIL [ 99%]
xarray/tests/test_weighted.py::test_weighted_operations_keep_attr_da_in_ds[mean] XFAIL [100%]

=============================== warnings summary ===============================
xarray/__init__.py:1
  /testbed/xarray/__init__.py:1: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

xarray/core/dask_array_compat.py:16
xarray/core/dask_array_compat.py:16
  /testbed/xarray/core/dask_array_compat.py:16: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    if LooseVersion(dask_version) >= LooseVersion("2.0.0"):

xarray/core/dask_array_compat.py:149
xarray/core/dask_array_compat.py:149
  /testbed/xarray/core/dask_array_compat.py:149: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    if LooseVersion(dask_version) >= LooseVersion("2.8.1"):

xarray/core/dask_array_compat.py:186
xarray/core/dask_array_compat.py:186
  /testbed/xarray/core/dask_array_compat.py:186: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    if LooseVersion(dask_version) > LooseVersion("2.9.0"):

xarray/core/pdcompat.py:45
  /testbed/xarray/core/pdcompat.py:45: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    if LooseVersion(pd.__version__) < "0.25.0":

../root/.venv/lib/python3.10/site-packages/setuptools/_distutils/version.py:345
  /root/.venv/lib/python3.10/site-packages/setuptools/_distutils/version.py:345: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    other = LooseVersion(other)

xarray/tests/__init__.py:54
xarray/tests/__init__.py:54
  /testbed/xarray/tests/__init__.py:54: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    return version.LooseVersion(vstring)

xarray/tests/test_weighted.py: 18 warnings
  /testbed/xarray/core/alignment.py:304: FutureWarning: Index.__and__ operating as a set operation is deprecated, in the future this will be a logical operation matching Series.__and__.  Use index.intersection(other) instead.
    index = joiner(matching_indexes)

xarray/tests/test_weighted.py: 10 warnings
  /testbed/xarray/core/formatting.py:143: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
  Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
    elif isinstance(x, (float, np.float)):

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================= 958 passed, 2 xfailed, 39 warnings in 7.03s ==================


=== Iteration 26/100 ===
Calling LLM with timeout=600.0s...
LLM Response: Excellent! All the existing tests pass, which means our fix doesn't break any existing functionality. Now let's run one final test to make sure our fix works correctly with the original reproduction c...
Executing tool: r2e_bash_executor
Tool parameters: {
  "command": "python reproduce_issue.py"
}
Tool execution status: success
Tool stdout:
[STDOUT]
Data array: [1. 1. 1.]
Weights array: [ True  True False]
Weights dtype: bool
Weighted mean result: 1.0
Expected result: 1.0
Result matches expected: True
Sum of weights: 2.0
Sum of weights dtype: float64
[STDERR]
/testbed/reproduce_issue.py:6: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  wgt = xr.DataArray(np.array([1, 1, 0], dtype=np.bool))


=== Iteration 27/100 ===
Calling LLM with timeout=600.0s...
LLM Response: Perfect! The fix is working correctly. Let me summarize what we've accomplished:

## Summary

I successfully implemented a fix for the GitHub issue where boolean weights in weighted mean operations we...
Tool parsing returned empty list - treating as completion
Generating patch from testbed changes...
Generating patch against base_commit: 19b088636eb7d3f65ab7a1046ac672e0689371d8
Patch generated successfully, size: 4513 characters
Patch preview (first 5 lines):
  diff --git a/debug_dot_issue.py b/debug_dot_issue.py
  new file mode 100644
  index 00000000..d99b5a98
  --- /dev/null
  +++ b/debug_dot_issue.py
  ... (132 more lines)
Saved patch to: single-output-v14/pydata__xarray-4075.patch
Task finished, pod r2e-pydata-xarray-4075-6942 will be deleted by context manager
Context saved to single-output-v14/pydata__xarray-4075.context
=== Task completed with status: success ===
=== Pod r2e-pydata-xarray-4075-6942 cleanup delegated to context manager ===
